{"version":"1.2","metadata":{"language":{"name":"ruby","engine":"ruby","version":"2.6.2"},"client":{"name":"appmap","url":"https://github.com/applandinc/appmap-ruby","version":"0.26.1"},"frameworks":[{"name":"rails","version":"6.0.3.1"},{"name":"rspec","version":"3.9.2"}],"git":{"repository":"git@github.com:applandinc/discourse.git","branch":"master","commit":"32fd4b3aab495794a8b45d85fb5cca2201161e3c","status":["M Gemfile.lock","M config/initializers/150-appmap.rb","D spec/requests/posts_controller_spec.rb","M spec/requests/user_actions_controller_spec.rb","M spec/requests/users_controller_spec.rb"],"git_last_annotated_tag":"v2.5.0.beta5","git_last_tag":"v2.5.0.beta5","git_commits_since_last_annotated_tag":0,"git_commits_since_last_tag":0},"name":"UsersController #enable_second_factor_totp creates a totp for the user successfully","app":"Discourse","feature":"UsersController #enable_second_factor_totp","feature_group":"Users","recorder":{"name":"rspec"}},"classMap":[{"name":"app/models","type":"package","children":[{"name":"LocaleSiteSetting","type":"class","children":[{"name":"fallback_locale","type":"function","location":"app/models/locale_site_setting.rb:62","static":true}]},{"name":"UserAuthToken(id: integer, user_id: integer, auth_token: string, prev_auth_token: string, user_agent: string, auth_token_seen: boolean, client_ip: inet, rotated_at: datetime, created_at: datetime, updated_at: datetime, seen_at: datetime)","type":"class","children":[{"name":"lookup","type":"function","location":"app/models/user_auth_token.rb:99","static":true},{"name":"hash_token","type":"function","location":"app/models/user_auth_token.rb:164","static":true},{"name":"log","type":"function","location":"app/models/user_auth_token.rb:26","static":true}]},{"name":"GlobalSetting","type":"class","children":[{"name":"safe_secret_key_base","type":"function","location":"app/models/global_setting.rb:25","static":true}]},{"name":"User","type":"class","children":[{"name":"suspended?","type":"function","location":"app/models/user.rb:869","static":false},{"name":"update_last_seen!","type":"function","location":"app/models/user.rb:721","static":false},{"name":"update_visit_record!","type":"function","location":"app/models/user.rb:680","static":false},{"name":"visit_record_for","type":"function","location":"app/models/user.rb:676","static":false},{"name":"create_visit_record!","type":"function","location":"app/models/user.rb:671","static":false},{"name":"seen_before?","type":"function","location":"app/models/user.rb:667","static":false},{"name":"update_ip_address!","type":"function","location":"app/models/user.rb:715","static":false},{"name":"effective_locale","type":"function","location":"app/models/user.rb:321","static":false},{"name":"email","type":"function","location":"app/models/user.rb:1194","static":false}]},{"name":"SecondFactorManager","type":"class","children":[{"name":"totp_provisioning_uri","type":"function","location":"app/models/concerns/second_factor_manager.rb:26","static":false},{"name":"get_totp_object","type":"function","location":"app/models/concerns/second_factor_manager.rb:21","static":false},{"name":"require_rotp","type":"function","location":"app/models/concerns/second_factor_manager.rb:248","static":false},{"name":"create_totp","type":"function","location":"app/models/concerns/second_factor_manager.rb:12","static":false}]},{"name":"ApplicationRequest(id: integer, date: date, req_type: integer, count: integer)","type":"class","children":[{"name":"increment!","type":"function","location":"app/models/application_request.rb:26","static":true}]},{"name":"UserSecondFactor(id: integer, user_id: integer, method: integer, data: string, enabled: boolean, last_used: datetime, created_at: datetime, updated_at: datetime, name: string)","type":"class","children":[{"name":"methods","type":"function","location":"app/models/user_second_factor.rb:19","static":true}]}]},{"name":"app/controllers","type":"package","children":[{"name":"ApplicationController","type":"class","children":[{"name":"handle_theme","type":"function","location":"app/controllers/application_controller.rb:388","static":false},{"name":"resolve_safe_mode","type":"function","location":"app/controllers/application_controller.rb:377","static":false},{"name":"guardian","type":"function","location":"app/controllers/application_controller.rb:423","static":false},{"name":"set_current_user_for_logs","type":"function","location":"app/controllers/application_controller.rb:294","static":false},{"name":"clear_notifications","type":"function","location":"app/controllers/application_controller.rb:302","static":false},{"name":"set_locale","type":"function","location":"app/controllers/application_controller.rb:328","static":false},{"name":"set_mobile_view","type":"function","location":"app/controllers/application_controller.rb:368","static":false},{"name":"requires_login_arg","type":"function","location":"app/controllers/application_controller.rb:669","static":true},{"name":"preload_json","type":"function","location":"app/controllers/application_controller.rb:352","static":false},{"name":"secure_session","type":"function","location":"app/controllers/application_controller.rb:507","static":false},{"name":"conditionally_allow_site_embedding","type":"function","location":"app/controllers/application_controller.rb:92","static":false},{"name":"dont_cache_page","type":"function","location":"app/controllers/application_controller.rb:85","static":false},{"name":"perform_refresh_session","type":"function","location":"app/controllers/application_controller.rb:75","static":false}]},{"name":"UsersController","type":"class","children":[{"name":"second_factor_check_confirmed_password","type":"function","location":"app/controllers/users_controller.rb:1338","static":false},{"name":"create_second_factor_totp","type":"function","location":"app/controllers/users_controller.rb:1205","static":false},{"name":"enable_second_factor_totp","type":"function","location":"app/controllers/users_controller.rb:1265","static":false}]}]},{"name":"lib/auth","type":"package","children":[{"name":"Auth","type":"class","children":[{"name":"DefaultCurrentUserProvider","type":"class","children":[{"name":"current_user","type":"function","location":"lib/auth/default_current_user_provider.rb:61","static":false},{"name":"should_update_last_seen?","type":"function","location":"lib/auth/default_current_user_provider.rb:286","static":false},{"name":"is_api?","type":"function","location":"lib/auth/default_current_user_provider.rb:271","static":false},{"name":"is_user_api?","type":"function","location":"lib/auth/default_current_user_provider.rb:276","static":false},{"name":"refresh_session","type":"function","location":"lib/auth/default_current_user_provider.rb:173","static":false},{"name":"has_auth_cookie?","type":"function","location":"lib/auth/default_current_user_provider.rb:281","static":false}]}]}]},{"name":"lib/guardian","type":"package","children":[{"name":"Guardian","type":"class","children":[{"name":"can_enable_safe_mode?","type":"function","location":"lib/guardian.rb:149","static":false},{"name":"allow_themes?","type":"function","location":"lib/guardian.rb:474","static":false}]}]}],"events":[{"id":924735,"event":"call","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parameters":[{"name":"locale","class":"Symbol","object_id":70097724306540,"value":"en_US","kind":"req"}],"receiver":{"class":"Class","object_id":70097569845280,"value":"LocaleSiteSetting"}},{"id":924736,"event":"return","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parent_id":924735,"elapsed":6.0e-06,"return_value":{"class":"Symbol","value":"en","object_id":3894428}},{"id":924737,"event":"call","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parameters":[{"name":"locale","class":"Symbol","object_id":3894428,"value":"en","kind":"req"}],"receiver":{"class":"Class","object_id":70097569845280,"value":"LocaleSiteSetting"}},{"id":924738,"event":"return","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parent_id":924737,"elapsed":1.1e-05},{"id":924739,"event":"call","defined_class":"AppMap::Rails::ActionHandler::HTTPServerRequest","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/action_handler.rb","lineno":50,"static":false,"thread_id":70097708498960,"http_server_request":{"request_method":"POST","path_info":"/users/create_second_factor_totp.json"},"message":[{"name":"controller","class":"String","value":"users","object_id":70097757254640},{"name":"action","class":"String","value":"create_second_factor_totp","object_id":70097757254620},{"name":"format","class":"String","value":"json","object_id":70097827100840}]},{"id":924740,"event":"call","defined_class":"ApplicationController","method_id":"handle_theme","path":"app/controllers/application_controller.rb","lineno":388,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097827099580,"value":"#<UsersController:0x00007f81d82ae778>"}},{"id":924741,"event":"call","defined_class":"ApplicationController","method_id":"resolve_safe_mode","path":"app/controllers/application_controller.rb","lineno":377,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097827099580,"value":"#<UsersController:0x00007f81d82ae778>"}},{"id":924742,"event":"call","defined_class":"ApplicationController","method_id":"guardian","path":"app/controllers/application_controller.rb","lineno":423,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097827099580,"value":"#<UsersController:0x00007f81d82ae778>"}},{"id":924743,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924744,"event":"call","defined_class":"UserAuthToken(id: integer, user_id: integer, auth_token: string, prev_auth_token: string, user_agent: string, auth_token_seen: boolean, client_ip: inet, rotated_at: datetime, created_at: datetime, updated_at: datetime, seen_at: datetime)","method_id":"lookup","path":"app/models/user_auth_token.rb","lineno":99,"static":true,"thread_id":70097708498960,"parameters":[{"name":"unhashed_token","class":"String","object_id":70097827130940,"value":"bce382cee135ac13cbc5216633d79903","kind":"req"},{"name":"opts","class":"Hash","object_id":70097827130380,"value":"{:seen=>true, :user_agent=>nil, :path=>nil, :client_ip=>\"127.0.0.1\"}","kind":"opt"}],"receiver":{"class":"Class","object_id":70097712007000,"value":"UserAuthToken"}},{"id":924745,"event":"call","defined_class":"UserAuthToken(id: integer, user_id: integer, auth_token: string, prev_auth_token: string, user_agent: string, auth_token_seen: boolean, client_ip: inet, rotated_at: datetime, created_at: datetime, updated_at: datetime, seen_at: datetime)","method_id":"hash_token","path":"app/models/user_auth_token.rb","lineno":164,"static":true,"thread_id":70097708498960,"parameters":[{"name":"token","class":"String","object_id":70097827130940,"value":"bce382cee135ac13cbc5216633d79903","kind":"req"}],"receiver":{"class":"Class","object_id":70097712007000,"value":"UserAuthToken"}},{"id":924746,"event":"call","defined_class":"GlobalSetting","method_id":"safe_secret_key_base","path":"app/models/global_setting.rb","lineno":25,"static":true,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"Class","object_id":70097703221560,"value":"GlobalSetting"}},{"id":924747,"event":"return","defined_class":"GlobalSetting","method_id":"safe_secret_key_base","path":"app/models/global_setting.rb","lineno":25,"static":true,"thread_id":70097708498960,"parent_id":924746,"elapsed":8.0e-06,"return_value":{"class":"String","value":"9a861fe75a448752d4997880bb647b45e1a210a880a56024d1dc12cdd3fa29354dc83c1a5e3ff086d25ac9454040e6f43418","object_id":70097709303360}},{"id":924748,"event":"return","defined_class":"UserAuthToken(id: integer, user_id: integer, auth_token: string, prev_auth_token: string, user_agent: string, auth_token_seen: boolean, client_ip: inet, rotated_at: datetime, created_at: datetime, updated_at: datetime, seen_at: datetime)","method_id":"hash_token","path":"app/models/user_auth_token.rb","lineno":164,"static":true,"thread_id":70097708498960,"parent_id":924745,"elapsed":0.000131,"return_value":{"class":"String","value":"m36No9O4J+8HBqu6oI5s0PBO9xA=","object_id":70097827147640}},{"id":924749,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SELECT \"user_auth_tokens\".* FROM \"user_auth_tokens\" WHERE ((auth_token = 'm36No9O4J+8HBqu6oI5s0PBO9xA=' OR\n                          prev_auth_token = 'm36No9O4J+8HBqu6oI5s0PBO9xA=') AND rotated_at > '2020-03-29 19:00:18.630130') LIMIT 1","database_type":"postgres","server_version":110006}},{"id":924750,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":924749,"elapsed":0.001332},{"id":924751,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"UPDATE \"user_auth_tokens\" SET \"auth_token_seen\" = TRUE, \"seen_at\" = '2020-05-28 19:00:18.635826' WHERE \"user_auth_tokens\".\"id\" = 1070 AND \"user_auth_tokens\".\"auth_token\" = 'm36No9O4J+8HBqu6oI5s0PBO9xA='","database_type":"postgres","server_version":110006}},{"id":924752,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":924751,"elapsed":0.001671},{"id":924753,"event":"call","defined_class":"UserAuthToken(id: integer, user_id: integer, auth_token: string, prev_auth_token: string, user_agent: string, auth_token_seen: boolean, client_ip: inet, rotated_at: datetime, created_at: datetime, updated_at: datetime, seen_at: datetime)","method_id":"log","path":"app/models/user_auth_token.rb","lineno":26,"static":true,"thread_id":70097708498960,"parameters":[{"name":"info","class":"Hash","object_id":70097827991280,"value":"{:action=>\"seen token\", :user_auth_token_id=>1070, :user_id=>1246, :auth_token=>\"m36No9O4J+8HBqu6oI5","kind":"req"}],"receiver":{"class":"Class","object_id":70097712007000,"value":"UserAuthToken"}},{"id":924754,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":924755,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":924754,"elapsed":0.001409},{"id":924756,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"INSERT INTO \"user_auth_token_logs\" (\"action\", \"user_auth_token_id\", \"user_id\", \"client_ip\", \"auth_token\", \"created_at\") VALUES ('seen token', 1070, 1246, '127.0.0.1/32', 'm36No9O4J+8HBqu6oI5s0PBO9xA=', '2020-05-28 19:00:18.646616') RETURNING \"id\"","database_type":"postgres","server_version":110006}},{"id":924757,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":924756,"elapsed":0.001616},{"id":924758,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"RELEASE SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":924759,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":924758,"elapsed":0.001382},{"id":924760,"event":"return","defined_class":"UserAuthToken(id: integer, user_id: integer, auth_token: string, prev_auth_token: string, user_agent: string, auth_token_seen: boolean, client_ip: inet, rotated_at: datetime, created_at: datetime, updated_at: datetime, seen_at: datetime)","method_id":"log","path":"app/models/user_auth_token.rb","lineno":26,"static":true,"thread_id":70097708498960,"parent_id":924753,"elapsed":0.016428,"return_value":{"class":"UserAuthTokenLog","value":"#<UserAuthTokenLog:0x00007f81d8461070>","object_id":70097827989560}},{"id":924761,"event":"return","defined_class":"UserAuthToken(id: integer, user_id: integer, auth_token: string, prev_auth_token: string, user_agent: string, auth_token_seen: boolean, client_ip: inet, rotated_at: datetime, created_at: datetime, updated_at: datetime, seen_at: datetime)","method_id":"lookup","path":"app/models/user_auth_token.rb","lineno":99,"static":true,"thread_id":70097708498960,"parent_id":924744,"elapsed":0.028242,"return_value":{"class":"UserAuthToken","value":"#<UserAuthToken:0x00007f81be0c5048>","object_id":70097607993380}},{"id":924762,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SELECT \"users\".* FROM \"users\" WHERE \"users\".\"id\" = 1246 LIMIT 1","database_type":"postgres","server_version":110006}},{"id":924763,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":924762,"elapsed":0.001673},{"id":924764,"event":"call","defined_class":"User","method_id":"suspended?","path":"app/models/user.rb","lineno":869,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"User","object_id":70097613261320,"value":"#<User:0x00007f81bead1410>"}},{"id":924765,"event":"return","defined_class":"User","method_id":"suspended?","path":"app/models/user.rb","lineno":869,"static":false,"thread_id":70097708498960,"parent_id":924764,"elapsed":2.3e-05},{"id":924766,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"should_update_last_seen?","path":"lib/auth/default_current_user_provider.rb","lineno":286,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924767,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"should_update_last_seen?","path":"lib/auth/default_current_user_provider.rb","lineno":286,"static":false,"thread_id":70097708498960,"parent_id":924766,"elapsed":0.001287,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":924768,"event":"call","defined_class":"User","method_id":"update_last_seen!","path":"app/models/user.rb","lineno":721,"static":false,"thread_id":70097708498960,"parameters":[{"name":"now","class":"NilClass","object_id":8,"value":null,"kind":"opt"}],"receiver":{"class":"User","object_id":70097613261320,"value":"#<User:0x00007f81bead1410>"}},{"id":924769,"event":"call","defined_class":"User","method_id":"update_visit_record!","path":"app/models/user.rb","lineno":680,"static":false,"thread_id":70097708498960,"parameters":[{"name":"date","class":"Date","object_id":70097613276760,"value":"2020-05-28","kind":"req"}],"receiver":{"class":"User","object_id":70097613261320,"value":"#<User:0x00007f81bead1410>"}},{"id":924770,"event":"call","defined_class":"User","method_id":"visit_record_for","path":"app/models/user.rb","lineno":676,"static":false,"thread_id":70097708498960,"parameters":[{"name":"date","class":"Date","object_id":70097613276760,"value":"2020-05-28","kind":"req"}],"receiver":{"class":"User","object_id":70097613261320,"value":"#<User:0x00007f81bead1410>"}},{"id":924771,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SELECT \"user_visits\".* FROM \"user_visits\" WHERE \"user_visits\".\"user_id\" = 1246 AND \"user_visits\".\"visited_at\" = '2020-05-28' LIMIT 1","database_type":"postgres","server_version":110006}},{"id":924772,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":924771,"elapsed":0.0016},{"id":924773,"event":"return","defined_class":"User","method_id":"visit_record_for","path":"app/models/user.rb","lineno":676,"static":false,"thread_id":70097708498960,"parent_id":924770,"elapsed":0.006243},{"id":924774,"event":"call","defined_class":"User","method_id":"create_visit_record!","path":"app/models/user.rb","lineno":671,"static":false,"thread_id":70097708498960,"parameters":[{"name":"date","class":"Date","object_id":70097613276760,"value":"2020-05-28","kind":"req"},{"name":"opts","class":"NilClass","object_id":8,"value":null,"kind":"opt"}],"receiver":{"class":"User","object_id":70097613261320,"value":"#<User:0x00007f81bead1410>"}},{"id":924775,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SELECT \"user_stats\".\"user_id\", \"user_stats\".\"topics_entered\", \"user_stats\".\"time_read\", \"user_stats\".\"days_visited\", \"user_stats\".\"posts_read_count\", \"user_stats\".\"likes_given\", \"user_stats\".\"likes_received\", \"user_stats\".\"new_since\", \"user_stats\".\"read_faq\", \"user_stats\".\"first_post_created_at\", \"user_stats\".\"post_count\", \"user_stats\".\"topic_count\", \"user_stats\".\"bounce_score\", \"user_stats\".\"reset_bounce_score_after\", \"user_stats\".\"flags_agreed\", \"user_stats\".\"flags_disagreed\", \"user_stats\".\"flags_ignored\", \"user_stats\".\"first_unread_at\", \"user_stats\".\"distinct_badge_count\" FROM \"user_stats\" WHERE \"user_stats\".\"user_id\" = 1246 LIMIT 1","database_type":"postgres","server_version":110006}},{"id":924776,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":924775,"elapsed":0.001424},{"id":924777,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"UPDATE \"user_stats\" SET \"days_visited\" = 1 WHERE \"user_stats\".\"user_id\" = 1246","database_type":"postgres","server_version":110006}},{"id":924778,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":924777,"elapsed":0.001358},{"id":924779,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":924780,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":924779,"elapsed":0.001208},{"id":924781,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"INSERT INTO \"user_visits\" (\"user_id\", \"visited_at\") VALUES (1246, '2020-05-28') RETURNING \"id\"","database_type":"postgres","server_version":110006}},{"id":924782,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":924781,"elapsed":0.001471},{"id":924783,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"RELEASE SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":924784,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":924783,"elapsed":0.001074},{"id":924785,"event":"return","defined_class":"User","method_id":"create_visit_record!","path":"app/models/user.rb","lineno":671,"static":false,"thread_id":70097708498960,"parent_id":924774,"elapsed":0.025746,"return_value":{"class":"UserVisit","value":"#<UserVisit:0x00007f81d4eedf60>","object_id":70097799966640}},{"id":924786,"event":"return","defined_class":"User","method_id":"update_visit_record!","path":"app/models/user.rb","lineno":680,"static":false,"thread_id":70097708498960,"parent_id":924769,"elapsed":0.032378,"return_value":{"class":"UserVisit","value":"#<UserVisit:0x00007f81d4eedf60>","object_id":70097799966640}},{"id":924787,"event":"call","defined_class":"User","method_id":"seen_before?","path":"app/models/user.rb","lineno":667,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"User","object_id":70097613261320,"value":"#<User:0x00007f81bead1410>"}},{"id":924788,"event":"return","defined_class":"User","method_id":"seen_before?","path":"app/models/user.rb","lineno":667,"static":false,"thread_id":70097708498960,"parent_id":924787,"elapsed":2.5e-05},{"id":924789,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"UPDATE \"users\" SET \"last_seen_at\" = '2020-05-28 19:00:18.665925' WHERE \"users\".\"id\" = 1246","database_type":"postgres","server_version":110006}},{"id":924790,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":924789,"elapsed":0.001523},{"id":924791,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"UPDATE \"users\" SET \"first_seen_at\" = '2020-05-28 19:00:18.665925' WHERE \"users\".\"id\" = 1246","database_type":"postgres","server_version":110006}},{"id":924792,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":924791,"elapsed":0.001467},{"id":924793,"event":"return","defined_class":"User","method_id":"update_last_seen!","path":"app/models/user.rb","lineno":721,"static":false,"thread_id":70097708498960,"parent_id":924768,"elapsed":0.044509},{"id":924794,"event":"call","defined_class":"User","method_id":"update_ip_address!","path":"app/models/user.rb","lineno":715,"static":false,"thread_id":70097708498960,"parameters":[{"name":"new_ip_address","class":"String","object_id":70097613280300,"value":"127.0.0.1","kind":"req"}],"receiver":{"class":"User","object_id":70097613261320,"value":"#<User:0x00007f81bead1410>"}},{"id":924795,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"UPDATE \"users\" SET \"ip_address\" = '127.0.0.1' WHERE \"users\".\"id\" = 1246","database_type":"postgres","server_version":110006}},{"id":924796,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":924795,"elapsed":0.001392},{"id":924797,"event":"return","defined_class":"User","method_id":"update_ip_address!","path":"app/models/user.rb","lineno":715,"static":false,"thread_id":70097708498960,"parent_id":924794,"elapsed":0.004563,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":924798,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924743,"elapsed":0.085517,"return_value":{"class":"User","value":"#<User:0x00007f81bead1410>","object_id":70097613261320}},{"id":924799,"event":"return","defined_class":"ApplicationController","method_id":"guardian","path":"app/controllers/application_controller.rb","lineno":423,"static":false,"thread_id":70097708498960,"parent_id":924742,"elapsed":0.08571,"return_value":{"class":"Guardian","value":"#<Guardian:0x00007f81bbe48510>","object_id":70097589912200}},{"id":924800,"event":"call","defined_class":"Guardian","method_id":"can_enable_safe_mode?","path":"lib/guardian.rb","lineno":149,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"Guardian","object_id":70097589912200,"value":"#<Guardian:0x00007f81bbe48510>"}},{"id":924801,"event":"return","defined_class":"Guardian","method_id":"can_enable_safe_mode?","path":"lib/guardian.rb","lineno":149,"static":false,"thread_id":70097708498960,"parent_id":924800,"elapsed":9.0e-06,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":924802,"event":"return","defined_class":"ApplicationController","method_id":"resolve_safe_mode","path":"app/controllers/application_controller.rb","lineno":377,"static":false,"thread_id":70097708498960,"parent_id":924741,"elapsed":0.085986},{"id":924803,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924804,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924803,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81bead1410>","object_id":70097613261320}},{"id":924805,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SELECT \"user_options\".* FROM \"user_options\" WHERE \"user_options\".\"user_id\" = 1246 LIMIT 1","database_type":"postgres","server_version":110006}},{"id":924806,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":924805,"elapsed":0.001265},{"id":924807,"event":"call","defined_class":"ApplicationController","method_id":"guardian","path":"app/controllers/application_controller.rb","lineno":423,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097827099580,"value":"#<UsersController:0x00007f81d82ae778>"}},{"id":924808,"event":"return","defined_class":"ApplicationController","method_id":"guardian","path":"app/controllers/application_controller.rb","lineno":423,"static":false,"thread_id":70097708498960,"parent_id":924807,"elapsed":5.0e-06,"return_value":{"class":"Guardian","value":"#<Guardian:0x00007f81bbe48510>","object_id":70097589912200}},{"id":924809,"event":"call","defined_class":"Guardian","method_id":"allow_themes?","path":"lib/guardian.rb","lineno":474,"static":false,"thread_id":70097708498960,"parameters":[{"name":"theme_ids","class":"Array","object_id":70097569624880,"value":"[]","kind":"req"},{"name":"include_preview","class":"NilClass","object_id":8,"value":null,"kind":"key"}],"receiver":{"class":"Guardian","object_id":70097589912200,"value":"#<Guardian:0x00007f81bbe48510>"}},{"id":924810,"event":"return","defined_class":"Guardian","method_id":"allow_themes?","path":"lib/guardian.rb","lineno":474,"static":false,"thread_id":70097708498960,"parent_id":924809,"elapsed":4.0e-06,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":924811,"event":"return","defined_class":"ApplicationController","method_id":"handle_theme","path":"app/controllers/application_controller.rb","lineno":388,"static":false,"thread_id":70097708498960,"parent_id":924740,"elapsed":0.091196,"return_value":{"class":"Array","value":"[2]","object_id":70097569624880}},{"id":924812,"event":"call","defined_class":"ApplicationController","method_id":"set_current_user_for_logs","path":"app/controllers/application_controller.rb","lineno":294,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097827099580,"value":"#<UsersController:0x00007f81d82ae778>"}},{"id":924813,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924814,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924813,"elapsed":4.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81bead1410>","object_id":70097613261320}},{"id":924815,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924816,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924815,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81bead1410>","object_id":70097613261320}},{"id":924817,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924818,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924817,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81bead1410>","object_id":70097613261320}},{"id":924819,"event":"return","defined_class":"ApplicationController","method_id":"set_current_user_for_logs","path":"app/controllers/application_controller.rb","lineno":294,"static":false,"thread_id":70097708498960,"parent_id":924812,"elapsed":0.000381,"return_value":{"class":"String","value":"users/create_second_factor_totp","object_id":70097615332880}},{"id":924820,"event":"call","defined_class":"ApplicationController","method_id":"clear_notifications","path":"app/controllers/application_controller.rb","lineno":302,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097827099580,"value":"#<UsersController:0x00007f81d82ae778>"}},{"id":924821,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924822,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924821,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81bead1410>","object_id":70097613261320}},{"id":924823,"event":"return","defined_class":"ApplicationController","method_id":"clear_notifications","path":"app/controllers/application_controller.rb","lineno":302,"static":false,"thread_id":70097708498960,"parent_id":924820,"elapsed":0.000119},{"id":924824,"event":"call","defined_class":"ApplicationController","method_id":"set_locale","path":"app/controllers/application_controller.rb","lineno":328,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097827099580,"value":"#<UsersController:0x00007f81d82ae778>"}},{"id":924825,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924826,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924825,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81bead1410>","object_id":70097613261320}},{"id":924827,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924828,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924827,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81bead1410>","object_id":70097613261320}},{"id":924829,"event":"call","defined_class":"User","method_id":"effective_locale","path":"app/models/user.rb","lineno":321,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"User","object_id":70097613261320,"value":"#<User:0x00007f81bead1410>"}},{"id":924830,"event":"return","defined_class":"User","method_id":"effective_locale","path":"app/models/user.rb","lineno":321,"static":false,"thread_id":70097708498960,"parent_id":924829,"elapsed":1.3e-05,"return_value":{"class":"String","value":"en_US","object_id":70097724286060}},{"id":924831,"event":"call","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parameters":[{"name":"locale","class":"Symbol","object_id":70097724306540,"value":"en_US","kind":"req"}],"receiver":{"class":"Class","object_id":70097569845280,"value":"LocaleSiteSetting"}},{"id":924832,"event":"return","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parent_id":924831,"elapsed":4.0e-06,"return_value":{"class":"Symbol","value":"en","object_id":3894428}},{"id":924833,"event":"call","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parameters":[{"name":"locale","class":"Symbol","object_id":3894428,"value":"en","kind":"req"}],"receiver":{"class":"Class","object_id":70097569845280,"value":"LocaleSiteSetting"}},{"id":924834,"event":"return","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parent_id":924833,"elapsed":9.0e-06},{"id":924835,"event":"call","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parameters":[{"name":"locale","class":"Symbol","object_id":70097724306540,"value":"en_US","kind":"req"}],"receiver":{"class":"Class","object_id":70097569845280,"value":"LocaleSiteSetting"}},{"id":924836,"event":"return","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parent_id":924835,"elapsed":3.0e-06,"return_value":{"class":"Symbol","value":"en","object_id":3894428}},{"id":924837,"event":"call","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parameters":[{"name":"locale","class":"Symbol","object_id":3894428,"value":"en","kind":"req"}],"receiver":{"class":"Class","object_id":70097569845280,"value":"LocaleSiteSetting"}},{"id":924838,"event":"return","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parent_id":924837,"elapsed":6.0e-06},{"id":924839,"event":"return","defined_class":"ApplicationController","method_id":"set_locale","path":"app/controllers/application_controller.rb","lineno":328,"static":false,"thread_id":70097708498960,"parent_id":924824,"elapsed":0.000757,"return_value":{"class":"Array","value":"[:en_US, :en]","object_id":70097615364440}},{"id":924840,"event":"call","defined_class":"ApplicationController","method_id":"set_mobile_view","path":"app/controllers/application_controller.rb","lineno":368,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097827099580,"value":"#<UsersController:0x00007f81d82ae778>"}},{"id":924841,"event":"return","defined_class":"ApplicationController","method_id":"set_mobile_view","path":"app/controllers/application_controller.rb","lineno":368,"static":false,"thread_id":70097708498960,"parent_id":924840,"elapsed":7.0e-06},{"id":924842,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_api?","path":"lib/auth/default_current_user_provider.rb","lineno":271,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924843,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924844,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924843,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81bead1410>","object_id":70097613261320}},{"id":924845,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_api?","path":"lib/auth/default_current_user_provider.rb","lineno":271,"static":false,"thread_id":70097708498960,"parent_id":924842,"elapsed":0.000105},{"id":924846,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924847,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924846,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81bead1410>","object_id":70097613261320}},{"id":924848,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924849,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924848,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81bead1410>","object_id":70097613261320}},{"id":924850,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924851,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924850,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81bead1410>","object_id":70097613261320}},{"id":924852,"event":"call","defined_class":"ApplicationController","method_id":"requires_login_arg","path":"app/controllers/application_controller.rb","lineno":669,"static":true,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"Class","object_id":70097775906280,"value":"UsersController"}},{"id":924853,"event":"return","defined_class":"ApplicationController","method_id":"requires_login_arg","path":"app/controllers/application_controller.rb","lineno":669,"static":true,"thread_id":70097708498960,"parent_id":924852,"elapsed":3.0e-06,"return_value":{"class":"Hash","value":"{:only=>[:username, :update, :user_preferences_redirect, :upload_user_image, :pick_avatar, :destroy_","object_id":70097777085280}},{"id":924854,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924855,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924854,"elapsed":4.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81bead1410>","object_id":70097613261320}},{"id":924856,"event":"call","defined_class":"ApplicationController","method_id":"preload_json","path":"app/controllers/application_controller.rb","lineno":352,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097827099580,"value":"#<UsersController:0x00007f81d82ae778>"}},{"id":924857,"event":"return","defined_class":"ApplicationController","method_id":"preload_json","path":"app/controllers/application_controller.rb","lineno":352,"static":false,"thread_id":70097708498960,"parent_id":924856,"elapsed":8.0e-06},{"id":924858,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_api?","path":"lib/auth/default_current_user_provider.rb","lineno":271,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924859,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924860,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924859,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81bead1410>","object_id":70097613261320}},{"id":924861,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_api?","path":"lib/auth/default_current_user_provider.rb","lineno":271,"static":false,"thread_id":70097708498960,"parent_id":924858,"elapsed":0.0001},{"id":924862,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_user_api?","path":"lib/auth/default_current_user_provider.rb","lineno":276,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924863,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924864,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924863,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81bead1410>","object_id":70097613261320}},{"id":924865,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_user_api?","path":"lib/auth/default_current_user_provider.rb","lineno":276,"static":false,"thread_id":70097708498960,"parent_id":924862,"elapsed":9.9e-05},{"id":924866,"event":"call","defined_class":"UsersController","method_id":"second_factor_check_confirmed_password","path":"app/controllers/users_controller.rb","lineno":1338,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097827099580,"value":"#<UsersController:0x00007f81d82ae778>"}},{"id":924867,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924868,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924867,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81bead1410>","object_id":70097613261320}},{"id":924869,"event":"return","defined_class":"UsersController","method_id":"second_factor_check_confirmed_password","path":"app/controllers/users_controller.rb","lineno":1338,"static":false,"thread_id":70097708498960,"parent_id":924866,"elapsed":0.000151},{"id":924870,"event":"call","defined_class":"UsersController","method_id":"create_second_factor_totp","path":"app/controllers/users_controller.rb","lineno":1205,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097827099580,"value":"#<UsersController:0x00007f81d82ae778>"}},{"id":924871,"event":"call","defined_class":"ApplicationController","method_id":"secure_session","path":"app/controllers/application_controller.rb","lineno":507,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097827099580,"value":"#<UsersController:0x00007f81d82ae778>"}},{"id":924872,"event":"return","defined_class":"ApplicationController","method_id":"secure_session","path":"app/controllers/application_controller.rb","lineno":507,"static":false,"thread_id":70097708498960,"parent_id":924871,"elapsed":0.000249,"return_value":{"class":"SecureSession","value":"#<SecureSession:0x00007f81beefc3f0>","object_id":70097615446520}},{"id":924873,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924874,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924873,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81bead1410>","object_id":70097613261320}},{"id":924875,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924876,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924875,"elapsed":7.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81bead1410>","object_id":70097613261320}},{"id":924877,"event":"call","defined_class":"SecondFactorManager","method_id":"totp_provisioning_uri","path":"app/models/concerns/second_factor_manager.rb","lineno":26,"static":false,"thread_id":70097708498960,"parameters":[{"name":"data","class":"String","object_id":70097615434380,"value":"2QDIF5VGEKU2HF43KOSQVJU43HJUVLKW","kind":"req"}],"receiver":{"class":"User","object_id":70097613261320,"value":"#<User:0x00007f81bead1410>"}},{"id":924878,"event":"call","defined_class":"SecondFactorManager","method_id":"get_totp_object","path":"app/models/concerns/second_factor_manager.rb","lineno":21,"static":false,"thread_id":70097708498960,"parameters":[{"name":"data","class":"String","object_id":70097615434380,"value":"2QDIF5VGEKU2HF43KOSQVJU43HJUVLKW","kind":"req"}],"receiver":{"class":"User","object_id":70097613261320,"value":"#<User:0x00007f81bead1410>"}},{"id":924879,"event":"call","defined_class":"SecondFactorManager","method_id":"require_rotp","path":"app/models/concerns/second_factor_manager.rb","lineno":248,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"User","object_id":70097613261320,"value":"#<User:0x00007f81bead1410>"}},{"id":924880,"event":"return","defined_class":"SecondFactorManager","method_id":"require_rotp","path":"app/models/concerns/second_factor_manager.rb","lineno":248,"static":false,"thread_id":70097708498960,"parent_id":924879,"elapsed":5.0e-06},{"id":924881,"event":"return","defined_class":"SecondFactorManager","method_id":"get_totp_object","path":"app/models/concerns/second_factor_manager.rb","lineno":21,"static":false,"thread_id":70097708498960,"parent_id":924878,"elapsed":0.000113,"return_value":{"class":"ROTP::TOTP","value":"#<ROTP::TOTP:0x00007f81bef0f978>","object_id":70097615486140}},{"id":924882,"event":"call","defined_class":"User","method_id":"email","path":"app/models/user.rb","lineno":1194,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"User","object_id":70097613261320,"value":"#<User:0x00007f81bead1410>"}},{"id":924883,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SELECT \"user_emails\".\"id\", \"user_emails\".\"user_id\", \"user_emails\".\"email\", \"user_emails\".\"primary\", \"user_emails\".\"created_at\", \"user_emails\".\"updated_at\" FROM \"user_emails\" WHERE \"user_emails\".\"user_id\" = 1246 AND \"user_emails\".\"primary\" = TRUE LIMIT 1","database_type":"postgres","server_version":110006}},{"id":924884,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":924883,"elapsed":0.001413},{"id":924885,"event":"return","defined_class":"User","method_id":"email","path":"app/models/user.rb","lineno":1194,"static":false,"thread_id":70097708498960,"parent_id":924882,"elapsed":0.005189,"return_value":{"class":"String","value":"bruce1122@wayne.com","object_id":70097624638480}},{"id":924886,"event":"return","defined_class":"SecondFactorManager","method_id":"totp_provisioning_uri","path":"app/models/concerns/second_factor_manager.rb","lineno":26,"static":false,"thread_id":70097708498960,"parent_id":924877,"elapsed":0.005648,"return_value":{"class":"String","value":"otpauth://totp/Discourse:bruce1122@wayne.com?secret=2QDIF5VGEKU2HF43KOSQVJU43HJUVLKW&issuer=Discours","object_id":70097624659680}},{"id":924887,"event":"return","defined_class":"UsersController","method_id":"create_second_factor_totp","path":"app/controllers/users_controller.rb","lineno":1205,"static":false,"thread_id":70097708498960,"parent_id":924870,"elapsed":0.13377,"return_value":{"class":"String","value":"{\"success\":\"OK\",\"key\":\"2QDI F5VG EKU2 HF43 KOSQ VJU4 3HJU VLKW\",\"qr\":\"\\u003c?xml version=\\\"1.0\\\" sta","object_id":70097732247480}},{"id":924888,"event":"call","defined_class":"ApplicationController","method_id":"conditionally_allow_site_embedding","path":"app/controllers/application_controller.rb","lineno":92,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097827099580,"value":"#<UsersController:0x00007f81d82ae778>"}},{"id":924889,"event":"return","defined_class":"ApplicationController","method_id":"conditionally_allow_site_embedding","path":"app/controllers/application_controller.rb","lineno":92,"static":false,"thread_id":70097708498960,"parent_id":924888,"elapsed":9.0e-06},{"id":924890,"event":"call","defined_class":"ApplicationController","method_id":"dont_cache_page","path":"app/controllers/application_controller.rb","lineno":85,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097827099580,"value":"#<UsersController:0x00007f81d82ae778>"}},{"id":924891,"event":"return","defined_class":"ApplicationController","method_id":"dont_cache_page","path":"app/controllers/application_controller.rb","lineno":85,"static":false,"thread_id":70097708498960,"parent_id":924890,"elapsed":6.0e-06,"return_value":{"class":"Array","value":"[\"no-store\"]","object_id":70097732261100}},{"id":924892,"event":"call","defined_class":"ApplicationController","method_id":"perform_refresh_session","path":"app/controllers/application_controller.rb","lineno":75,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097827099580,"value":"#<UsersController:0x00007f81d82ae778>"}},{"id":924893,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924894,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924893,"elapsed":4.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81bead1410>","object_id":70097613261320}},{"id":924895,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"refresh_session","path":"lib/auth/default_current_user_provider.rb","lineno":173,"static":false,"thread_id":70097708498960,"parameters":[{"name":"user","class":"User","object_id":70097613261320,"value":"#<User:0x00007f81bead1410>","kind":"req"},{"name":"session","class":"ActionDispatch::Request::Session","object_id":70097799311640,"value":"#<ActionDispatch::Request::Session:0x00007f81d4dae230>","kind":"req"},{"name":"cookies","class":"ActionDispatch::Cookies::CookieJar","object_id":70097569625140,"value":"#<ActionDispatch::Cookies::CookieJar:0x00007f81b9796868>","kind":"req"}],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924896,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_api?","path":"lib/auth/default_current_user_provider.rb","lineno":271,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924897,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924898,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924897,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81bead1410>","object_id":70097613261320}},{"id":924899,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_api?","path":"lib/auth/default_current_user_provider.rb","lineno":271,"static":false,"thread_id":70097708498960,"parent_id":924896,"elapsed":9.1e-05},{"id":924900,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_user_api?","path":"lib/auth/default_current_user_provider.rb","lineno":276,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924901,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097827132740,"value":"#<TestCurrentUserProvider:0x00007f81d82bea88>"}},{"id":924902,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924901,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81bead1410>","object_id":70097613261320}},{"id":924903,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_user_api?","path":"lib/auth/default_current_user_provider.rb","lineno":276,"static":false,"thread_id":70097708498960,"parent_id":924900,"elapsed":8.8e-05},{"id":924904,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"refresh_session","path":"lib/auth/default_current_user_provider.rb","lineno":173,"static":false,"thread_id":70097708498960,"parent_id":924895,"elapsed":0.000416},{"id":924905,"event":"return","defined_class":"ApplicationController","method_id":"perform_refresh_session","path":"app/controllers/application_controller.rb","lineno":75,"static":false,"thread_id":70097708498960,"parent_id":924892,"elapsed":0.000637},{"id":924906,"event":"return","defined_class":"AppMap::Rails::ActionHandler::HTTPServerResponse","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/action_handler.rb","lineno":85,"static":false,"thread_id":70097708498960,"parent_id":924739,"elapsed":0.230773,"http_server_response":{"status":200}},{"id":924907,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"has_auth_cookie?","path":"lib/auth/default_current_user_provider.rb","lineno":281,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097732360600,"value":"#<TestCurrentUserProvider:0x00007f81ccdfb330>"}},{"id":924908,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"has_auth_cookie?","path":"lib/auth/default_current_user_provider.rb","lineno":281,"static":false,"thread_id":70097708498960,"parent_id":924907,"elapsed":7.0e-06,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":924909,"event":"call","defined_class":"ApplicationRequest(id: integer, date: date, req_type: integer, count: integer)","method_id":"increment!","path":"app/models/application_request.rb","lineno":26,"static":true,"thread_id":70097708498960,"parameters":[{"name":"type","class":"Symbol","object_id":13040028,"value":"http_total","kind":"req"},{"name":"opts","class":"NilClass","object_id":8,"value":null,"kind":"opt"}],"receiver":{"class":"Class","object_id":70097802320860,"value":"ApplicationRequest"}},{"id":924910,"event":"return","defined_class":"ApplicationRequest(id: integer, date: date, req_type: integer, count: integer)","method_id":"increment!","path":"app/models/application_request.rb","lineno":26,"static":true,"thread_id":70097708498960,"parent_id":924909,"elapsed":6.0e-06},{"id":924911,"event":"call","defined_class":"ApplicationRequest(id: integer, date: date, req_type: integer, count: integer)","method_id":"increment!","path":"app/models/application_request.rb","lineno":26,"static":true,"thread_id":70097708498960,"parameters":[{"name":"type","class":"Symbol","object_id":13041948,"value":"http_2xx","kind":"req"},{"name":"opts","class":"NilClass","object_id":8,"value":null,"kind":"opt"}],"receiver":{"class":"Class","object_id":70097802320860,"value":"ApplicationRequest"}},{"id":924912,"event":"return","defined_class":"ApplicationRequest(id: integer, date: date, req_type: integer, count: integer)","method_id":"increment!","path":"app/models/application_request.rb","lineno":26,"static":true,"thread_id":70097708498960,"parent_id":924911,"elapsed":3.0e-06},{"id":924913,"event":"call","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parameters":[{"name":"locale","class":"Symbol","object_id":70097724306540,"value":"en_US","kind":"req"}],"receiver":{"class":"Class","object_id":70097569845280,"value":"LocaleSiteSetting"}},{"id":924914,"event":"return","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parent_id":924913,"elapsed":6.0e-06,"return_value":{"class":"Symbol","value":"en","object_id":3894428}},{"id":924915,"event":"call","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parameters":[{"name":"locale","class":"Symbol","object_id":3894428,"value":"en","kind":"req"}],"receiver":{"class":"Class","object_id":70097569845280,"value":"LocaleSiteSetting"}},{"id":924916,"event":"return","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parent_id":924915,"elapsed":1.0e-05},{"id":924917,"event":"call","defined_class":"AppMap::Rails::ActionHandler::HTTPServerRequest","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/action_handler.rb","lineno":50,"static":false,"thread_id":70097708498960,"http_server_request":{"request_method":"POST","path_info":"/users/enable_second_factor_totp.json"},"message":[{"name":"name","class":"String","value":"test","object_id":70097732493060},{"name":"second_factor_token","class":"String","value":"[FILTERED]","object_id":70097717781280},{"name":"controller","class":"String","value":"users","object_id":70097757273680},{"name":"action","class":"String","value":"enable_second_factor_totp","object_id":70097757273660},{"name":"format","class":"String","value":"json","object_id":70097732667280}]},{"id":924918,"event":"call","defined_class":"ApplicationController","method_id":"handle_theme","path":"app/controllers/application_controller.rb","lineno":388,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097732689560,"value":"#<UsersController:0x00007f81cce9bd30>"}},{"id":924919,"event":"call","defined_class":"ApplicationController","method_id":"resolve_safe_mode","path":"app/controllers/application_controller.rb","lineno":377,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097732689560,"value":"#<UsersController:0x00007f81cce9bd30>"}},{"id":924920,"event":"call","defined_class":"ApplicationController","method_id":"guardian","path":"app/controllers/application_controller.rb","lineno":423,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097732689560,"value":"#<UsersController:0x00007f81cce9bd30>"}},{"id":924921,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":924922,"event":"call","defined_class":"UserAuthToken(id: integer, user_id: integer, auth_token: string, prev_auth_token: string, user_agent: string, auth_token_seen: boolean, client_ip: inet, rotated_at: datetime, created_at: datetime, updated_at: datetime, seen_at: datetime)","method_id":"lookup","path":"app/models/user_auth_token.rb","lineno":99,"static":true,"thread_id":70097708498960,"parameters":[{"name":"unhashed_token","class":"String","object_id":70097720738300,"value":"bce382cee135ac13cbc5216633d79903","kind":"req"},{"name":"opts","class":"Hash","object_id":70097720761620,"value":"{:seen=>true, :user_agent=>nil, :path=>nil, :client_ip=>\"127.0.0.1\"}","kind":"opt"}],"receiver":{"class":"Class","object_id":70097712007000,"value":"UserAuthToken"}},{"id":924923,"event":"call","defined_class":"UserAuthToken(id: integer, user_id: integer, auth_token: string, prev_auth_token: string, user_agent: string, auth_token_seen: boolean, client_ip: inet, rotated_at: datetime, created_at: datetime, updated_at: datetime, seen_at: datetime)","method_id":"hash_token","path":"app/models/user_auth_token.rb","lineno":164,"static":true,"thread_id":70097708498960,"parameters":[{"name":"token","class":"String","object_id":70097720738300,"value":"bce382cee135ac13cbc5216633d79903","kind":"req"}],"receiver":{"class":"Class","object_id":70097712007000,"value":"UserAuthToken"}},{"id":924924,"event":"call","defined_class":"GlobalSetting","method_id":"safe_secret_key_base","path":"app/models/global_setting.rb","lineno":25,"static":true,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"Class","object_id":70097703221560,"value":"GlobalSetting"}},{"id":924925,"event":"return","defined_class":"GlobalSetting","method_id":"safe_secret_key_base","path":"app/models/global_setting.rb","lineno":25,"static":true,"thread_id":70097708498960,"parent_id":924924,"elapsed":8.0e-06,"return_value":{"class":"String","value":"9a861fe75a448752d4997880bb647b45e1a210a880a56024d1dc12cdd3fa29354dc83c1a5e3ff086d25ac9454040e6f43418","object_id":70097709303360}},{"id":924926,"event":"return","defined_class":"UserAuthToken(id: integer, user_id: integer, auth_token: string, prev_auth_token: string, user_agent: string, auth_token_seen: boolean, client_ip: inet, rotated_at: datetime, created_at: datetime, updated_at: datetime, seen_at: datetime)","method_id":"hash_token","path":"app/models/user_auth_token.rb","lineno":164,"static":true,"thread_id":70097708498960,"parent_id":924923,"elapsed":0.000111,"return_value":{"class":"String","value":"m36No9O4J+8HBqu6oI5s0PBO9xA=","object_id":70097720772320}},{"id":924927,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SELECT \"user_auth_tokens\".* FROM \"user_auth_tokens\" WHERE ((auth_token = 'm36No9O4J+8HBqu6oI5s0PBO9xA=' OR\n                          prev_auth_token = 'm36No9O4J+8HBqu6oI5s0PBO9xA=') AND rotated_at > '2020-03-29 19:00:18.866062') LIMIT 1","database_type":"postgres","server_version":110006}},{"id":924928,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":924927,"elapsed":0.001266},{"id":924929,"event":"return","defined_class":"UserAuthToken(id: integer, user_id: integer, auth_token: string, prev_auth_token: string, user_agent: string, auth_token_seen: boolean, client_ip: inet, rotated_at: datetime, created_at: datetime, updated_at: datetime, seen_at: datetime)","method_id":"lookup","path":"app/models/user_auth_token.rb","lineno":99,"static":true,"thread_id":70097708498960,"parent_id":924922,"elapsed":0.005411,"return_value":{"class":"UserAuthToken","value":"#<UserAuthToken:0x00007f81d81c2580>","object_id":70097826616000}},{"id":924930,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SELECT \"users\".* FROM \"users\" WHERE \"users\".\"id\" = 1246 LIMIT 1","database_type":"postgres","server_version":110006}},{"id":924931,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":924930,"elapsed":0.001242},{"id":924932,"event":"call","defined_class":"User","method_id":"suspended?","path":"app/models/user.rb","lineno":869,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"User","object_id":70097732494380,"value":"#<User:0x00007f81cce3c858>"}},{"id":924933,"event":"return","defined_class":"User","method_id":"suspended?","path":"app/models/user.rb","lineno":869,"static":false,"thread_id":70097708498960,"parent_id":924932,"elapsed":1.8e-05},{"id":924934,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"should_update_last_seen?","path":"lib/auth/default_current_user_provider.rb","lineno":286,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":924935,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"should_update_last_seen?","path":"lib/auth/default_current_user_provider.rb","lineno":286,"static":false,"thread_id":70097708498960,"parent_id":924934,"elapsed":0.001092,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":924936,"event":"call","defined_class":"User","method_id":"update_last_seen!","path":"app/models/user.rb","lineno":721,"static":false,"thread_id":70097708498960,"parameters":[{"name":"now","class":"NilClass","object_id":8,"value":null,"kind":"opt"}],"receiver":{"class":"User","object_id":70097732494380,"value":"#<User:0x00007f81cce3c858>"}},{"id":924937,"event":"return","defined_class":"User","method_id":"update_last_seen!","path":"app/models/user.rb","lineno":721,"static":false,"thread_id":70097708498960,"parent_id":924936,"elapsed":0.000911},{"id":924938,"event":"call","defined_class":"User","method_id":"update_ip_address!","path":"app/models/user.rb","lineno":715,"static":false,"thread_id":70097708498960,"parameters":[{"name":"new_ip_address","class":"String","object_id":70097732512440,"value":"127.0.0.1","kind":"req"}],"receiver":{"class":"User","object_id":70097732494380,"value":"#<User:0x00007f81cce3c858>"}},{"id":924939,"event":"return","defined_class":"User","method_id":"update_ip_address!","path":"app/models/user.rb","lineno":715,"static":false,"thread_id":70097708498960,"parent_id":924938,"elapsed":3.6e-05},{"id":924940,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924921,"elapsed":0.013256,"return_value":{"class":"User","value":"#<User:0x00007f81cce3c858>","object_id":70097732494380}},{"id":924941,"event":"return","defined_class":"ApplicationController","method_id":"guardian","path":"app/controllers/application_controller.rb","lineno":423,"static":false,"thread_id":70097708498960,"parent_id":924920,"elapsed":0.013367,"return_value":{"class":"Guardian","value":"#<Guardian:0x00007f81cce4e1c0>","object_id":70097732530400}},{"id":924942,"event":"call","defined_class":"Guardian","method_id":"can_enable_safe_mode?","path":"lib/guardian.rb","lineno":149,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"Guardian","object_id":70097732530400,"value":"#<Guardian:0x00007f81cce4e1c0>"}},{"id":924943,"event":"return","defined_class":"Guardian","method_id":"can_enable_safe_mode?","path":"lib/guardian.rb","lineno":149,"static":false,"thread_id":70097708498960,"parent_id":924942,"elapsed":9.0e-06,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":924944,"event":"return","defined_class":"ApplicationController","method_id":"resolve_safe_mode","path":"app/controllers/application_controller.rb","lineno":377,"static":false,"thread_id":70097708498960,"parent_id":924919,"elapsed":0.013603},{"id":924945,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":924946,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924945,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cce3c858>","object_id":70097732494380}},{"id":924947,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SELECT \"user_options\".* FROM \"user_options\" WHERE \"user_options\".\"user_id\" = 1246 LIMIT 1","database_type":"postgres","server_version":110006}},{"id":924948,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":924947,"elapsed":0.000974},{"id":924949,"event":"call","defined_class":"ApplicationController","method_id":"guardian","path":"app/controllers/application_controller.rb","lineno":423,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097732689560,"value":"#<UsersController:0x00007f81cce9bd30>"}},{"id":924950,"event":"return","defined_class":"ApplicationController","method_id":"guardian","path":"app/controllers/application_controller.rb","lineno":423,"static":false,"thread_id":70097708498960,"parent_id":924949,"elapsed":6.0e-06,"return_value":{"class":"Guardian","value":"#<Guardian:0x00007f81cce4e1c0>","object_id":70097732530400}},{"id":924951,"event":"call","defined_class":"Guardian","method_id":"allow_themes?","path":"lib/guardian.rb","lineno":474,"static":false,"thread_id":70097708498960,"parameters":[{"name":"theme_ids","class":"Array","object_id":70097586985460,"value":"[]","kind":"req"},{"name":"include_preview","class":"NilClass","object_id":8,"value":null,"kind":"key"}],"receiver":{"class":"Guardian","object_id":70097732530400,"value":"#<Guardian:0x00007f81cce4e1c0>"}},{"id":924952,"event":"return","defined_class":"Guardian","method_id":"allow_themes?","path":"lib/guardian.rb","lineno":474,"static":false,"thread_id":70097708498960,"parent_id":924951,"elapsed":4.0e-06,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":924953,"event":"return","defined_class":"ApplicationController","method_id":"handle_theme","path":"app/controllers/application_controller.rb","lineno":388,"static":false,"thread_id":70097708498960,"parent_id":924918,"elapsed":0.018824,"return_value":{"class":"Array","value":"[2]","object_id":70097586985460}},{"id":924954,"event":"call","defined_class":"ApplicationController","method_id":"set_current_user_for_logs","path":"app/controllers/application_controller.rb","lineno":294,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097732689560,"value":"#<UsersController:0x00007f81cce9bd30>"}},{"id":924955,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":924956,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924955,"elapsed":5.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cce3c858>","object_id":70097732494380}},{"id":924957,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":924958,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924957,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cce3c858>","object_id":70097732494380}},{"id":924959,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":924960,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924959,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cce3c858>","object_id":70097732494380}},{"id":924961,"event":"return","defined_class":"ApplicationController","method_id":"set_current_user_for_logs","path":"app/controllers/application_controller.rb","lineno":294,"static":false,"thread_id":70097708498960,"parent_id":924954,"elapsed":0.000377,"return_value":{"class":"String","value":"users/enable_second_factor_totp","object_id":70097826691180}},{"id":924962,"event":"call","defined_class":"ApplicationController","method_id":"clear_notifications","path":"app/controllers/application_controller.rb","lineno":302,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097732689560,"value":"#<UsersController:0x00007f81cce9bd30>"}},{"id":924963,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":924964,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924963,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cce3c858>","object_id":70097732494380}},{"id":924965,"event":"return","defined_class":"ApplicationController","method_id":"clear_notifications","path":"app/controllers/application_controller.rb","lineno":302,"static":false,"thread_id":70097708498960,"parent_id":924962,"elapsed":0.000119},{"id":924966,"event":"call","defined_class":"ApplicationController","method_id":"set_locale","path":"app/controllers/application_controller.rb","lineno":328,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097732689560,"value":"#<UsersController:0x00007f81cce9bd30>"}},{"id":924967,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":924968,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924967,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cce3c858>","object_id":70097732494380}},{"id":924969,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":924970,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924969,"elapsed":5.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cce3c858>","object_id":70097732494380}},{"id":924971,"event":"call","defined_class":"User","method_id":"effective_locale","path":"app/models/user.rb","lineno":321,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"User","object_id":70097732494380,"value":"#<User:0x00007f81cce3c858>"}},{"id":924972,"event":"return","defined_class":"User","method_id":"effective_locale","path":"app/models/user.rb","lineno":321,"static":false,"thread_id":70097708498960,"parent_id":924971,"elapsed":7.0e-06,"return_value":{"class":"String","value":"en_US","object_id":70097724286060}},{"id":924973,"event":"call","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parameters":[{"name":"locale","class":"Symbol","object_id":70097724306540,"value":"en_US","kind":"req"}],"receiver":{"class":"Class","object_id":70097569845280,"value":"LocaleSiteSetting"}},{"id":924974,"event":"return","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parent_id":924973,"elapsed":4.0e-06,"return_value":{"class":"Symbol","value":"en","object_id":3894428}},{"id":924975,"event":"call","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parameters":[{"name":"locale","class":"Symbol","object_id":3894428,"value":"en","kind":"req"}],"receiver":{"class":"Class","object_id":70097569845280,"value":"LocaleSiteSetting"}},{"id":924976,"event":"return","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parent_id":924975,"elapsed":1.1e-05},{"id":924977,"event":"call","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parameters":[{"name":"locale","class":"Symbol","object_id":70097724306540,"value":"en_US","kind":"req"}],"receiver":{"class":"Class","object_id":70097569845280,"value":"LocaleSiteSetting"}},{"id":924978,"event":"return","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parent_id":924977,"elapsed":3.0e-06,"return_value":{"class":"Symbol","value":"en","object_id":3894428}},{"id":924979,"event":"call","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parameters":[{"name":"locale","class":"Symbol","object_id":3894428,"value":"en","kind":"req"}],"receiver":{"class":"Class","object_id":70097569845280,"value":"LocaleSiteSetting"}},{"id":924980,"event":"return","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parent_id":924979,"elapsed":7.0e-06},{"id":924981,"event":"return","defined_class":"ApplicationController","method_id":"set_locale","path":"app/controllers/application_controller.rb","lineno":328,"static":false,"thread_id":70097708498960,"parent_id":924966,"elapsed":0.000791,"return_value":{"class":"Array","value":"[:en_US, :en]","object_id":70097826787000}},{"id":924982,"event":"call","defined_class":"ApplicationController","method_id":"set_mobile_view","path":"app/controllers/application_controller.rb","lineno":368,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097732689560,"value":"#<UsersController:0x00007f81cce9bd30>"}},{"id":924983,"event":"return","defined_class":"ApplicationController","method_id":"set_mobile_view","path":"app/controllers/application_controller.rb","lineno":368,"static":false,"thread_id":70097708498960,"parent_id":924982,"elapsed":8.0e-06},{"id":924984,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_api?","path":"lib/auth/default_current_user_provider.rb","lineno":271,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":924985,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":924986,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924985,"elapsed":4.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cce3c858>","object_id":70097732494380}},{"id":924987,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_api?","path":"lib/auth/default_current_user_provider.rb","lineno":271,"static":false,"thread_id":70097708498960,"parent_id":924984,"elapsed":0.000101},{"id":924988,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":924989,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924988,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cce3c858>","object_id":70097732494380}},{"id":924990,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":924991,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924990,"elapsed":4.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cce3c858>","object_id":70097732494380}},{"id":924992,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":924993,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924992,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cce3c858>","object_id":70097732494380}},{"id":924994,"event":"call","defined_class":"ApplicationController","method_id":"requires_login_arg","path":"app/controllers/application_controller.rb","lineno":669,"static":true,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"Class","object_id":70097775906280,"value":"UsersController"}},{"id":924995,"event":"return","defined_class":"ApplicationController","method_id":"requires_login_arg","path":"app/controllers/application_controller.rb","lineno":669,"static":true,"thread_id":70097708498960,"parent_id":924994,"elapsed":3.0e-06,"return_value":{"class":"Hash","value":"{:only=>[:username, :update, :user_preferences_redirect, :upload_user_image, :pick_avatar, :destroy_","object_id":70097777085280}},{"id":924996,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":924997,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":924996,"elapsed":4.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cce3c858>","object_id":70097732494380}},{"id":924998,"event":"call","defined_class":"ApplicationController","method_id":"preload_json","path":"app/controllers/application_controller.rb","lineno":352,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097732689560,"value":"#<UsersController:0x00007f81cce9bd30>"}},{"id":924999,"event":"return","defined_class":"ApplicationController","method_id":"preload_json","path":"app/controllers/application_controller.rb","lineno":352,"static":false,"thread_id":70097708498960,"parent_id":924998,"elapsed":8.0e-06},{"id":925000,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_api?","path":"lib/auth/default_current_user_provider.rb","lineno":271,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":925001,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":925002,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":925001,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cce3c858>","object_id":70097732494380}},{"id":925003,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_api?","path":"lib/auth/default_current_user_provider.rb","lineno":271,"static":false,"thread_id":70097708498960,"parent_id":925000,"elapsed":0.000102},{"id":925004,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_user_api?","path":"lib/auth/default_current_user_provider.rb","lineno":276,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":925005,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":925006,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":925005,"elapsed":4.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cce3c858>","object_id":70097732494380}},{"id":925007,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_user_api?","path":"lib/auth/default_current_user_provider.rb","lineno":276,"static":false,"thread_id":70097708498960,"parent_id":925004,"elapsed":9.9e-05},{"id":925008,"event":"call","defined_class":"UsersController","method_id":"second_factor_check_confirmed_password","path":"app/controllers/users_controller.rb","lineno":1338,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097732689560,"value":"#<UsersController:0x00007f81cce9bd30>"}},{"id":925009,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":925010,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":925009,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cce3c858>","object_id":70097732494380}},{"id":925011,"event":"return","defined_class":"UsersController","method_id":"second_factor_check_confirmed_password","path":"app/controllers/users_controller.rb","lineno":1338,"static":false,"thread_id":70097708498960,"parent_id":925008,"elapsed":0.000169},{"id":925012,"event":"call","defined_class":"UsersController","method_id":"enable_second_factor_totp","path":"app/controllers/users_controller.rb","lineno":1265,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097732689560,"value":"#<UsersController:0x00007f81cce9bd30>"}},{"id":925013,"event":"call","defined_class":"ApplicationController","method_id":"secure_session","path":"app/controllers/application_controller.rb","lineno":507,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097732689560,"value":"#<UsersController:0x00007f81cce9bd30>"}},{"id":925014,"event":"return","defined_class":"ApplicationController","method_id":"secure_session","path":"app/controllers/application_controller.rb","lineno":507,"static":false,"thread_id":70097708498960,"parent_id":925013,"elapsed":0.000261,"return_value":{"class":"SecureSession","value":"#<SecureSession:0x00007f81d80a9e78>","object_id":70097826041660}},{"id":925015,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":925016,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":925015,"elapsed":4.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cce3c858>","object_id":70097732494380}},{"id":925017,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":925018,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":925017,"elapsed":6.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cce3c858>","object_id":70097732494380}},{"id":925019,"event":"call","defined_class":"SecondFactorManager","method_id":"get_totp_object","path":"app/models/concerns/second_factor_manager.rb","lineno":21,"static":false,"thread_id":70097708498960,"parameters":[{"name":"data","class":"String","object_id":70097826056920,"value":"2QDIF5VGEKU2HF43KOSQVJU43HJUVLKW","kind":"req"}],"receiver":{"class":"User","object_id":70097732494380,"value":"#<User:0x00007f81cce3c858>"}},{"id":925020,"event":"call","defined_class":"SecondFactorManager","method_id":"require_rotp","path":"app/models/concerns/second_factor_manager.rb","lineno":248,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"User","object_id":70097732494380,"value":"#<User:0x00007f81cce3c858>"}},{"id":925021,"event":"return","defined_class":"SecondFactorManager","method_id":"require_rotp","path":"app/models/concerns/second_factor_manager.rb","lineno":248,"static":false,"thread_id":70097708498960,"parent_id":925020,"elapsed":5.0e-06},{"id":925022,"event":"return","defined_class":"SecondFactorManager","method_id":"get_totp_object","path":"app/models/concerns/second_factor_manager.rb","lineno":21,"static":false,"thread_id":70097708498960,"parent_id":925019,"elapsed":0.000117,"return_value":{"class":"ROTP::TOTP","value":"#<ROTP::TOTP:0x00007f81d8234d60>","object_id":70097826850480}},{"id":925023,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":925024,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":925023,"elapsed":4.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cce3c858>","object_id":70097732494380}},{"id":925025,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":925026,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":925025,"elapsed":4.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cce3c858>","object_id":70097732494380}},{"id":925027,"event":"call","defined_class":"SecondFactorManager","method_id":"create_totp","path":"app/models/concerns/second_factor_manager.rb","lineno":12,"static":false,"thread_id":70097708498960,"parameters":[{"name":"opts","class":"Hash","object_id":70097826935860,"value":"{:data=>\"2QDIF5VGEKU2HF43KOSQVJU43HJUVLKW\", :name=>\"test\", :enabled=>true}","kind":"opt"}],"receiver":{"class":"User","object_id":70097732494380,"value":"#<User:0x00007f81cce3c858>"}},{"id":925028,"event":"call","defined_class":"SecondFactorManager","method_id":"require_rotp","path":"app/models/concerns/second_factor_manager.rb","lineno":248,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"User","object_id":70097732494380,"value":"#<User:0x00007f81cce3c858>"}},{"id":925029,"event":"return","defined_class":"SecondFactorManager","method_id":"require_rotp","path":"app/models/concerns/second_factor_manager.rb","lineno":248,"static":false,"thread_id":70097708498960,"parent_id":925028,"elapsed":3.0e-06},{"id":925030,"event":"call","defined_class":"UserSecondFactor(id: integer, user_id: integer, method: integer, data: string, enabled: boolean, last_used: datetime, created_at: datetime, updated_at: datetime, name: string)","method_id":"methods","path":"app/models/user_second_factor.rb","lineno":19,"static":true,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"Class","object_id":70097779296820,"value":"UserSecondFactor"}},{"id":925031,"event":"return","defined_class":"UserSecondFactor(id: integer, user_id: integer, method: integer, data: string, enabled: boolean, last_used: datetime, created_at: datetime, updated_at: datetime, name: string)","method_id":"methods","path":"app/models/user_second_factor.rb","lineno":19,"static":true,"thread_id":70097708498960,"parent_id":925030,"elapsed":3.0e-06,"return_value":{"class":"Enum","value":"{:totp=>1, :backup_codes=>2, :security_key=>3}","object_id":70097755302300}},{"id":925032,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":925033,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":925032,"elapsed":0.000812},{"id":925034,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"INSERT INTO \"user_second_factors\" (\"user_id\", \"method\", \"data\", \"enabled\", \"created_at\", \"updated_at\", \"name\") VALUES (1246, 1, '2QDIF5VGEKU2HF43KOSQVJU43HJUVLKW', TRUE, '2020-05-28 19:00:18.894790', '2020-05-28 19:00:18.894790', 'test') RETURNING \"id\"","database_type":"postgres","server_version":110006}},{"id":925035,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":925034,"elapsed":0.001365},{"id":925036,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"RELEASE SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":925037,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":925036,"elapsed":0.001289},{"id":925038,"event":"return","defined_class":"SecondFactorManager","method_id":"create_totp","path":"app/models/concerns/second_factor_manager.rb","lineno":12,"static":false,"thread_id":70097708498960,"parent_id":925027,"elapsed":0.014625,"return_value":{"class":"UserSecondFactor","value":"#<UserSecondFactor:0x00007f81d826fb40>","object_id":70097826971040}},{"id":925039,"event":"return","defined_class":"UsersController","method_id":"enable_second_factor_totp","path":"app/controllers/users_controller.rb","lineno":1265,"static":false,"thread_id":70097708498960,"parent_id":925012,"elapsed":0.017715,"return_value":{"class":"String","value":"{\"success\":\"OK\"}","object_id":70097591374100}},{"id":925040,"event":"call","defined_class":"ApplicationController","method_id":"conditionally_allow_site_embedding","path":"app/controllers/application_controller.rb","lineno":92,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097732689560,"value":"#<UsersController:0x00007f81cce9bd30>"}},{"id":925041,"event":"return","defined_class":"ApplicationController","method_id":"conditionally_allow_site_embedding","path":"app/controllers/application_controller.rb","lineno":92,"static":false,"thread_id":70097708498960,"parent_id":925040,"elapsed":1.0e-05},{"id":925042,"event":"call","defined_class":"ApplicationController","method_id":"dont_cache_page","path":"app/controllers/application_controller.rb","lineno":85,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097732689560,"value":"#<UsersController:0x00007f81cce9bd30>"}},{"id":925043,"event":"return","defined_class":"ApplicationController","method_id":"dont_cache_page","path":"app/controllers/application_controller.rb","lineno":85,"static":false,"thread_id":70097708498960,"parent_id":925042,"elapsed":7.0e-06,"return_value":{"class":"Array","value":"[\"no-store\"]","object_id":70097591390840}},{"id":925044,"event":"call","defined_class":"ApplicationController","method_id":"perform_refresh_session","path":"app/controllers/application_controller.rb","lineno":75,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097732689560,"value":"#<UsersController:0x00007f81cce9bd30>"}},{"id":925045,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":925046,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":925045,"elapsed":5.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cce3c858>","object_id":70097732494380}},{"id":925047,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"refresh_session","path":"lib/auth/default_current_user_provider.rb","lineno":173,"static":false,"thread_id":70097708498960,"parameters":[{"name":"user","class":"User","object_id":70097732494380,"value":"#<User:0x00007f81cce3c858>","kind":"req"},{"name":"session","class":"ActionDispatch::Request::Session","object_id":70097732490240,"value":"#<ActionDispatch::Request::Session:0x00007f81cce3a800>","kind":"req"},{"name":"cookies","class":"ActionDispatch::Cookies::CookieJar","object_id":70097586986060,"value":"#<ActionDispatch::Cookies::CookieJar:0x00007f81bb8b3898>","kind":"req"}],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":925048,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_api?","path":"lib/auth/default_current_user_provider.rb","lineno":271,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":925049,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":925050,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":925049,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cce3c858>","object_id":70097732494380}},{"id":925051,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_api?","path":"lib/auth/default_current_user_provider.rb","lineno":271,"static":false,"thread_id":70097708498960,"parent_id":925048,"elapsed":0.000114},{"id":925052,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_user_api?","path":"lib/auth/default_current_user_provider.rb","lineno":276,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":925053,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097720745420,"value":"#<TestCurrentUserProvider:0x00007f81cb7d3b98>"}},{"id":925054,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":925053,"elapsed":4.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cce3c858>","object_id":70097732494380}},{"id":925055,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_user_api?","path":"lib/auth/default_current_user_provider.rb","lineno":276,"static":false,"thread_id":70097708498960,"parent_id":925052,"elapsed":0.000113},{"id":925056,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"refresh_session","path":"lib/auth/default_current_user_provider.rb","lineno":173,"static":false,"thread_id":70097708498960,"parent_id":925047,"elapsed":0.000525},{"id":925057,"event":"return","defined_class":"ApplicationController","method_id":"perform_refresh_session","path":"app/controllers/application_controller.rb","lineno":75,"static":false,"thread_id":70097708498960,"parent_id":925044,"elapsed":0.000784},{"id":925058,"event":"return","defined_class":"AppMap::Rails::ActionHandler::HTTPServerResponse","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/action_handler.rb","lineno":85,"static":false,"thread_id":70097708498960,"parent_id":924917,"elapsed":0.042604,"http_server_response":{"status":200}},{"id":925059,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"has_auth_cookie?","path":"lib/auth/default_current_user_provider.rb","lineno":281,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097591420340,"value":"#<TestCurrentUserProvider:0x00007f81bc128b68>"}},{"id":925060,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"has_auth_cookie?","path":"lib/auth/default_current_user_provider.rb","lineno":281,"static":false,"thread_id":70097708498960,"parent_id":925059,"elapsed":8.0e-06,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":925061,"event":"call","defined_class":"ApplicationRequest(id: integer, date: date, req_type: integer, count: integer)","method_id":"increment!","path":"app/models/application_request.rb","lineno":26,"static":true,"thread_id":70097708498960,"parameters":[{"name":"type","class":"Symbol","object_id":13040028,"value":"http_total","kind":"req"},{"name":"opts","class":"NilClass","object_id":8,"value":null,"kind":"opt"}],"receiver":{"class":"Class","object_id":70097802320860,"value":"ApplicationRequest"}},{"id":925062,"event":"return","defined_class":"ApplicationRequest(id: integer, date: date, req_type: integer, count: integer)","method_id":"increment!","path":"app/models/application_request.rb","lineno":26,"static":true,"thread_id":70097708498960,"parent_id":925061,"elapsed":6.0e-06},{"id":925063,"event":"call","defined_class":"ApplicationRequest(id: integer, date: date, req_type: integer, count: integer)","method_id":"increment!","path":"app/models/application_request.rb","lineno":26,"static":true,"thread_id":70097708498960,"parameters":[{"name":"type","class":"Symbol","object_id":13041948,"value":"http_2xx","kind":"req"},{"name":"opts","class":"NilClass","object_id":8,"value":null,"kind":"opt"}],"receiver":{"class":"Class","object_id":70097802320860,"value":"ApplicationRequest"}},{"id":925064,"event":"return","defined_class":"ApplicationRequest(id: integer, date: date, req_type: integer, count: integer)","method_id":"increment!","path":"app/models/application_request.rb","lineno":26,"static":true,"thread_id":70097708498960,"parent_id":925063,"elapsed":4.0e-06},{"id":925065,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SELECT COUNT(*) FROM \"user_second_factors\" WHERE \"user_second_factors\".\"user_id\" = 1246","database_type":"postgres","server_version":110006}},{"id":925066,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":925065,"elapsed":0.001198}]}