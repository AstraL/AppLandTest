{"version":"1.2","metadata":{"language":{"name":"ruby","engine":"ruby","version":"2.6.2"},"client":{"name":"appmap","url":"https://github.com/applandinc/appmap-ruby","version":"0.26.1"},"frameworks":[{"name":"rails","version":"6.0.3.1"},{"name":"rspec","version":"3.9.2"}],"git":{"repository":"git@github.com:applandinc/discourse.git","branch":"master","commit":"32fd4b3aab495794a8b45d85fb5cca2201161e3c","status":["M Gemfile.lock","M config/initializers/150-appmap.rb","D spec/requests/posts_controller_spec.rb","M spec/requests/user_actions_controller_spec.rb","M spec/requests/users_controller_spec.rb"],"git_last_annotated_tag":"v2.5.0.beta5","git_last_tag":"v2.5.0.beta5","git_commits_since_last_annotated_tag":0,"git_commits_since_last_tag":0},"name":"UsersController #create_second_factor_backup when logged in create 2fa request succeeds on correct password","app":"Discourse","feature":"UsersController #create_second_factor_backup","feature_group":"Users","recorder":{"name":"rspec"}},"classMap":[{"name":"app/models","type":"package","children":[{"name":"LocaleSiteSetting","type":"class","children":[{"name":"fallback_locale","type":"function","location":"app/models/locale_site_setting.rb:62","static":true}]},{"name":"UserAuthToken(id: integer, user_id: integer, auth_token: string, prev_auth_token: string, user_agent: string, auth_token_seen: boolean, client_ip: inet, rotated_at: datetime, created_at: datetime, updated_at: datetime, seen_at: datetime)","type":"class","children":[{"name":"lookup","type":"function","location":"app/models/user_auth_token.rb:99","static":true},{"name":"hash_token","type":"function","location":"app/models/user_auth_token.rb:164","static":true},{"name":"log","type":"function","location":"app/models/user_auth_token.rb:26","static":true}]},{"name":"GlobalSetting","type":"class","children":[{"name":"safe_secret_key_base","type":"function","location":"app/models/global_setting.rb:25","static":true}]},{"name":"User","type":"class","children":[{"name":"suspended?","type":"function","location":"app/models/user.rb:869","static":false},{"name":"update_last_seen!","type":"function","location":"app/models/user.rb:721","static":false},{"name":"update_visit_record!","type":"function","location":"app/models/user.rb:680","static":false},{"name":"visit_record_for","type":"function","location":"app/models/user.rb:676","static":false},{"name":"create_visit_record!","type":"function","location":"app/models/user.rb:671","static":false},{"name":"seen_before?","type":"function","location":"app/models/user.rb:667","static":false},{"name":"update_ip_address!","type":"function","location":"app/models/user.rb:715","static":false},{"name":"effective_locale","type":"function","location":"app/models/user.rb:321","static":false}]},{"name":"SecondFactorManager","type":"class","children":[{"name":"generate_backup_codes","type":"function","location":"app/models/concerns/second_factor_manager.rb:191","static":false},{"name":"hash_backup_code","type":"function","location":"app/models/concerns/second_factor_manager.rb:244","static":false},{"name":"create_backup_codes","type":"function","location":"app/models/concerns/second_factor_manager.rb:214","static":false}]},{"name":"UserSecondFactor(id: integer, user_id: integer, method: integer, data: string, enabled: boolean, last_used: datetime, created_at: datetime, updated_at: datetime, name: string)","type":"class","children":[{"name":"methods","type":"function","location":"app/models/user_second_factor.rb:19","static":true}]},{"name":"ApplicationRequest(id: integer, date: date, req_type: integer, count: integer)","type":"class","children":[{"name":"increment!","type":"function","location":"app/models/application_request.rb:26","static":true}]}]},{"name":"app/controllers","type":"package","children":[{"name":"ApplicationController","type":"class","children":[{"name":"handle_theme","type":"function","location":"app/controllers/application_controller.rb:388","static":false},{"name":"resolve_safe_mode","type":"function","location":"app/controllers/application_controller.rb:377","static":false},{"name":"guardian","type":"function","location":"app/controllers/application_controller.rb:423","static":false},{"name":"set_current_user_for_logs","type":"function","location":"app/controllers/application_controller.rb:294","static":false},{"name":"clear_notifications","type":"function","location":"app/controllers/application_controller.rb:302","static":false},{"name":"set_locale","type":"function","location":"app/controllers/application_controller.rb:328","static":false},{"name":"set_mobile_view","type":"function","location":"app/controllers/application_controller.rb:368","static":false},{"name":"requires_login_arg","type":"function","location":"app/controllers/application_controller.rb:669","static":true},{"name":"preload_json","type":"function","location":"app/controllers/application_controller.rb:352","static":false},{"name":"conditionally_allow_site_embedding","type":"function","location":"app/controllers/application_controller.rb:92","static":false},{"name":"dont_cache_page","type":"function","location":"app/controllers/application_controller.rb:85","static":false},{"name":"perform_refresh_session","type":"function","location":"app/controllers/application_controller.rb:75","static":false}]},{"name":"UsersController","type":"class","children":[{"name":"second_factor_check_confirmed_password","type":"function","location":"app/controllers/users_controller.rb:1338","static":false},{"name":"create_second_factor_backup","type":"function","location":"app/controllers/users_controller.rb:1197","static":false}]}]},{"name":"lib/auth","type":"package","children":[{"name":"Auth","type":"class","children":[{"name":"DefaultCurrentUserProvider","type":"class","children":[{"name":"current_user","type":"function","location":"lib/auth/default_current_user_provider.rb:61","static":false},{"name":"should_update_last_seen?","type":"function","location":"lib/auth/default_current_user_provider.rb:286","static":false},{"name":"is_api?","type":"function","location":"lib/auth/default_current_user_provider.rb:271","static":false},{"name":"is_user_api?","type":"function","location":"lib/auth/default_current_user_provider.rb:276","static":false},{"name":"refresh_session","type":"function","location":"lib/auth/default_current_user_provider.rb:173","static":false},{"name":"has_auth_cookie?","type":"function","location":"lib/auth/default_current_user_provider.rb:281","static":false}]}]}]},{"name":"lib/guardian","type":"package","children":[{"name":"Guardian","type":"class","children":[{"name":"can_enable_safe_mode?","type":"function","location":"lib/guardian.rb:149","static":false},{"name":"allow_themes?","type":"function","location":"lib/guardian.rb:474","static":false}]}]}],"events":[{"id":866707,"event":"call","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parameters":[{"name":"locale","class":"Symbol","object_id":70097724306540,"value":"en_US","kind":"req"}],"receiver":{"class":"Class","object_id":70097569845280,"value":"LocaleSiteSetting"}},{"id":866708,"event":"return","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parent_id":866707,"elapsed":6.0e-06,"return_value":{"class":"Symbol","value":"en","object_id":3894428}},{"id":866709,"event":"call","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parameters":[{"name":"locale","class":"Symbol","object_id":3894428,"value":"en","kind":"req"}],"receiver":{"class":"Class","object_id":70097569845280,"value":"LocaleSiteSetting"}},{"id":866710,"event":"return","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parent_id":866709,"elapsed":1.0e-05},{"id":866711,"event":"call","defined_class":"AppMap::Rails::ActionHandler::HTTPServerRequest","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/action_handler.rb","lineno":50,"static":false,"thread_id":70097708498960,"http_server_request":{"request_method":"PUT","path_info":"/users/second_factors_backup.json"},"message":[{"name":"controller","class":"String","value":"users","object_id":70097757287220},{"name":"action","class":"String","value":"create_second_factor_backup","object_id":70097757287200},{"name":"format","class":"String","value":"json","object_id":70097589852860}]},{"id":866712,"event":"call","defined_class":"ApplicationController","method_id":"handle_theme","path":"app/controllers/application_controller.rb","lineno":388,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097589852080,"value":"#<UsersController:0x00007f81bbe2af60>"}},{"id":866713,"event":"call","defined_class":"ApplicationController","method_id":"resolve_safe_mode","path":"app/controllers/application_controller.rb","lineno":377,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097589852080,"value":"#<UsersController:0x00007f81bbe2af60>"}},{"id":866714,"event":"call","defined_class":"ApplicationController","method_id":"guardian","path":"app/controllers/application_controller.rb","lineno":423,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097589852080,"value":"#<UsersController:0x00007f81bbe2af60>"}},{"id":866715,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866716,"event":"call","defined_class":"UserAuthToken(id: integer, user_id: integer, auth_token: string, prev_auth_token: string, user_agent: string, auth_token_seen: boolean, client_ip: inet, rotated_at: datetime, created_at: datetime, updated_at: datetime, seen_at: datetime)","method_id":"lookup","path":"app/models/user_auth_token.rb","lineno":99,"static":true,"thread_id":70097708498960,"parameters":[{"name":"unhashed_token","class":"String","object_id":70097589886560,"value":"abbb0e45a35c72bcb8a2d6a46f7814f6","kind":"req"},{"name":"opts","class":"Hash","object_id":70097589886060,"value":"{:seen=>true, :user_agent=>nil, :path=>nil, :client_ip=>\"127.0.0.1\"}","kind":"opt"}],"receiver":{"class":"Class","object_id":70097712007000,"value":"UserAuthToken"}},{"id":866717,"event":"call","defined_class":"UserAuthToken(id: integer, user_id: integer, auth_token: string, prev_auth_token: string, user_agent: string, auth_token_seen: boolean, client_ip: inet, rotated_at: datetime, created_at: datetime, updated_at: datetime, seen_at: datetime)","method_id":"hash_token","path":"app/models/user_auth_token.rb","lineno":164,"static":true,"thread_id":70097708498960,"parameters":[{"name":"token","class":"String","object_id":70097589886560,"value":"abbb0e45a35c72bcb8a2d6a46f7814f6","kind":"req"}],"receiver":{"class":"Class","object_id":70097712007000,"value":"UserAuthToken"}},{"id":866718,"event":"call","defined_class":"GlobalSetting","method_id":"safe_secret_key_base","path":"app/models/global_setting.rb","lineno":25,"static":true,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"Class","object_id":70097703221560,"value":"GlobalSetting"}},{"id":866719,"event":"return","defined_class":"GlobalSetting","method_id":"safe_secret_key_base","path":"app/models/global_setting.rb","lineno":25,"static":true,"thread_id":70097708498960,"parent_id":866718,"elapsed":7.0e-06,"return_value":{"class":"String","value":"9a861fe75a448752d4997880bb647b45e1a210a880a56024d1dc12cdd3fa29354dc83c1a5e3ff086d25ac9454040e6f43418","object_id":70097709303360}},{"id":866720,"event":"return","defined_class":"UserAuthToken(id: integer, user_id: integer, auth_token: string, prev_auth_token: string, user_agent: string, auth_token_seen: boolean, client_ip: inet, rotated_at: datetime, created_at: datetime, updated_at: datetime, seen_at: datetime)","method_id":"hash_token","path":"app/models/user_auth_token.rb","lineno":164,"static":true,"thread_id":70097708498960,"parent_id":866717,"elapsed":0.000118,"return_value":{"class":"String","value":"LopU3qNkbTAsIANUlQDybh7C9l8=","object_id":70097589881300}},{"id":866721,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SELECT \"user_auth_tokens\".* FROM \"user_auth_tokens\" WHERE ((auth_token = 'LopU3qNkbTAsIANUlQDybh7C9l8=' OR\n                          prev_auth_token = 'LopU3qNkbTAsIANUlQDybh7C9l8=') AND rotated_at > '2020-03-29 18:59:43.689897') LIMIT 1","database_type":"postgres","server_version":110006}},{"id":866722,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866721,"elapsed":0.001173},{"id":866723,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"UPDATE \"user_auth_tokens\" SET \"auth_token_seen\" = TRUE, \"seen_at\" = '2020-05-28 18:59:43.694704' WHERE \"user_auth_tokens\".\"id\" = 1018 AND \"user_auth_tokens\".\"auth_token\" = 'LopU3qNkbTAsIANUlQDybh7C9l8='","database_type":"postgres","server_version":110006}},{"id":866724,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866723,"elapsed":0.001238},{"id":866725,"event":"call","defined_class":"UserAuthToken(id: integer, user_id: integer, auth_token: string, prev_auth_token: string, user_agent: string, auth_token_seen: boolean, client_ip: inet, rotated_at: datetime, created_at: datetime, updated_at: datetime, seen_at: datetime)","method_id":"log","path":"app/models/user_auth_token.rb","lineno":26,"static":true,"thread_id":70097708498960,"parameters":[{"name":"info","class":"Hash","object_id":70097615200600,"value":"{:action=>\"seen token\", :user_auth_token_id=>1018, :user_id=>1180, :auth_token=>\"LopU3qNkbTAsIANUlQD","kind":"req"}],"receiver":{"class":"Class","object_id":70097712007000,"value":"UserAuthToken"}},{"id":866726,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":866727,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866726,"elapsed":0.000933},{"id":866728,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"INSERT INTO \"user_auth_token_logs\" (\"action\", \"user_auth_token_id\", \"user_id\", \"client_ip\", \"auth_token\", \"created_at\") VALUES ('seen token', 1018, 1180, '127.0.0.1/32', 'LopU3qNkbTAsIANUlQDybh7C9l8=', '2020-05-28 18:59:43.703286') RETURNING \"id\"","database_type":"postgres","server_version":110006}},{"id":866729,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866728,"elapsed":0.001187},{"id":866730,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"RELEASE SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":866731,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866730,"elapsed":0.000861},{"id":866732,"event":"return","defined_class":"UserAuthToken(id: integer, user_id: integer, auth_token: string, prev_auth_token: string, user_agent: string, auth_token_seen: boolean, client_ip: inet, rotated_at: datetime, created_at: datetime, updated_at: datetime, seen_at: datetime)","method_id":"log","path":"app/models/user_auth_token.rb","lineno":26,"static":true,"thread_id":70097708498960,"parent_id":866725,"elapsed":0.053141,"return_value":{"class":"UserAuthTokenLog","value":"#<UserAuthTokenLog:0x00007f81bee8f390>","object_id":70097615223240}},{"id":866733,"event":"return","defined_class":"UserAuthToken(id: integer, user_id: integer, auth_token: string, prev_auth_token: string, user_agent: string, auth_token_seen: boolean, client_ip: inet, rotated_at: datetime, created_at: datetime, updated_at: datetime, seen_at: datetime)","method_id":"lookup","path":"app/models/user_auth_token.rb","lineno":99,"static":true,"thread_id":70097708498960,"parent_id":866716,"elapsed":0.062713,"return_value":{"class":"UserAuthToken","value":"#<UserAuthToken:0x00007f81b9797f38>","object_id":70097569628060}},{"id":866734,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SELECT \"users\".* FROM \"users\" WHERE \"users\".\"id\" = 1180 LIMIT 1","database_type":"postgres","server_version":110006}},{"id":866735,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866734,"elapsed":0.001866},{"id":866736,"event":"call","defined_class":"User","method_id":"suspended?","path":"app/models/user.rb","lineno":869,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"User","object_id":70097720128540,"value":"#<User:0x00007f81cb6a6838>"}},{"id":866737,"event":"return","defined_class":"User","method_id":"suspended?","path":"app/models/user.rb","lineno":869,"static":false,"thread_id":70097708498960,"parent_id":866736,"elapsed":2.0e-05},{"id":866738,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"should_update_last_seen?","path":"lib/auth/default_current_user_provider.rb","lineno":286,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866739,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"should_update_last_seen?","path":"lib/auth/default_current_user_provider.rb","lineno":286,"static":false,"thread_id":70097708498960,"parent_id":866738,"elapsed":0.001217,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":866740,"event":"call","defined_class":"User","method_id":"update_last_seen!","path":"app/models/user.rb","lineno":721,"static":false,"thread_id":70097708498960,"parameters":[{"name":"now","class":"NilClass","object_id":8,"value":null,"kind":"opt"}],"receiver":{"class":"User","object_id":70097720128540,"value":"#<User:0x00007f81cb6a6838>"}},{"id":866741,"event":"call","defined_class":"User","method_id":"update_visit_record!","path":"app/models/user.rb","lineno":680,"static":false,"thread_id":70097708498960,"parameters":[{"name":"date","class":"Date","object_id":70097729550480,"value":"2020-05-28","kind":"req"}],"receiver":{"class":"User","object_id":70097720128540,"value":"#<User:0x00007f81cb6a6838>"}},{"id":866742,"event":"call","defined_class":"User","method_id":"visit_record_for","path":"app/models/user.rb","lineno":676,"static":false,"thread_id":70097708498960,"parameters":[{"name":"date","class":"Date","object_id":70097729550480,"value":"2020-05-28","kind":"req"}],"receiver":{"class":"User","object_id":70097720128540,"value":"#<User:0x00007f81cb6a6838>"}},{"id":866743,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SELECT \"user_visits\".* FROM \"user_visits\" WHERE \"user_visits\".\"user_id\" = 1180 AND \"user_visits\".\"visited_at\" = '2020-05-28' LIMIT 1","database_type":"postgres","server_version":110006}},{"id":866744,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866743,"elapsed":0.002045},{"id":866745,"event":"return","defined_class":"User","method_id":"visit_record_for","path":"app/models/user.rb","lineno":676,"static":false,"thread_id":70097708498960,"parent_id":866742,"elapsed":0.006862},{"id":866746,"event":"call","defined_class":"User","method_id":"create_visit_record!","path":"app/models/user.rb","lineno":671,"static":false,"thread_id":70097708498960,"parameters":[{"name":"date","class":"Date","object_id":70097729550480,"value":"2020-05-28","kind":"req"},{"name":"opts","class":"NilClass","object_id":8,"value":null,"kind":"opt"}],"receiver":{"class":"User","object_id":70097720128540,"value":"#<User:0x00007f81cb6a6838>"}},{"id":866747,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SELECT \"user_stats\".\"user_id\", \"user_stats\".\"topics_entered\", \"user_stats\".\"time_read\", \"user_stats\".\"days_visited\", \"user_stats\".\"posts_read_count\", \"user_stats\".\"likes_given\", \"user_stats\".\"likes_received\", \"user_stats\".\"new_since\", \"user_stats\".\"read_faq\", \"user_stats\".\"first_post_created_at\", \"user_stats\".\"post_count\", \"user_stats\".\"topic_count\", \"user_stats\".\"bounce_score\", \"user_stats\".\"reset_bounce_score_after\", \"user_stats\".\"flags_agreed\", \"user_stats\".\"flags_disagreed\", \"user_stats\".\"flags_ignored\", \"user_stats\".\"first_unread_at\", \"user_stats\".\"distinct_badge_count\" FROM \"user_stats\" WHERE \"user_stats\".\"user_id\" = 1180 LIMIT 1","database_type":"postgres","server_version":110006}},{"id":866748,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866747,"elapsed":0.00121},{"id":866749,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"UPDATE \"user_stats\" SET \"days_visited\" = 1 WHERE \"user_stats\".\"user_id\" = 1180","database_type":"postgres","server_version":110006}},{"id":866750,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866749,"elapsed":0.001104},{"id":866751,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":866752,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866751,"elapsed":0.000906},{"id":866753,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"INSERT INTO \"user_visits\" (\"user_id\", \"visited_at\") VALUES (1180, '2020-05-28') RETURNING \"id\"","database_type":"postgres","server_version":110006}},{"id":866754,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866753,"elapsed":0.000992},{"id":866755,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"RELEASE SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":866756,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866755,"elapsed":0.000759},{"id":866757,"event":"return","defined_class":"User","method_id":"create_visit_record!","path":"app/models/user.rb","lineno":671,"static":false,"thread_id":70097708498960,"parent_id":866746,"elapsed":0.024696,"return_value":{"class":"UserVisit","value":"#<UserVisit:0x00007f81cce20158>","object_id":70097732436140}},{"id":866758,"event":"return","defined_class":"User","method_id":"update_visit_record!","path":"app/models/user.rb","lineno":680,"static":false,"thread_id":70097708498960,"parent_id":866741,"elapsed":0.0319,"return_value":{"class":"UserVisit","value":"#<UserVisit:0x00007f81cce20158>","object_id":70097732436140}},{"id":866759,"event":"call","defined_class":"User","method_id":"seen_before?","path":"app/models/user.rb","lineno":667,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"User","object_id":70097720128540,"value":"#<User:0x00007f81cb6a6838>"}},{"id":866760,"event":"return","defined_class":"User","method_id":"seen_before?","path":"app/models/user.rb","lineno":667,"static":false,"thread_id":70097708498960,"parent_id":866759,"elapsed":2.0e-05},{"id":866761,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"UPDATE \"users\" SET \"last_seen_at\" = '2020-05-28 18:59:43.760578' WHERE \"users\".\"id\" = 1180","database_type":"postgres","server_version":110006}},{"id":866762,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866761,"elapsed":0.001185},{"id":866763,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"UPDATE \"users\" SET \"first_seen_at\" = '2020-05-28 18:59:43.760578' WHERE \"users\".\"id\" = 1180","database_type":"postgres","server_version":110006}},{"id":866764,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866763,"elapsed":0.001207},{"id":866765,"event":"return","defined_class":"User","method_id":"update_last_seen!","path":"app/models/user.rb","lineno":721,"static":false,"thread_id":70097708498960,"parent_id":866740,"elapsed":0.042717},{"id":866766,"event":"call","defined_class":"User","method_id":"update_ip_address!","path":"app/models/user.rb","lineno":715,"static":false,"thread_id":70097708498960,"parameters":[{"name":"new_ip_address","class":"String","object_id":70097720209700,"value":"127.0.0.1","kind":"req"}],"receiver":{"class":"User","object_id":70097720128540,"value":"#<User:0x00007f81cb6a6838>"}},{"id":866767,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"UPDATE \"users\" SET \"ip_address\" = '127.0.0.1' WHERE \"users\".\"id\" = 1180","database_type":"postgres","server_version":110006}},{"id":866768,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866767,"elapsed":0.001123},{"id":866769,"event":"return","defined_class":"User","method_id":"update_ip_address!","path":"app/models/user.rb","lineno":715,"static":false,"thread_id":70097708498960,"parent_id":866766,"elapsed":0.004201,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":866770,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":866715,"elapsed":0.118199,"return_value":{"class":"User","value":"#<User:0x00007f81cb6a6838>","object_id":70097720128540}},{"id":866771,"event":"return","defined_class":"ApplicationController","method_id":"guardian","path":"app/controllers/application_controller.rb","lineno":423,"static":false,"thread_id":70097708498960,"parent_id":866714,"elapsed":0.118375,"return_value":{"class":"Guardian","value":"#<Guardian:0x00007f81bc13b420>","object_id":70097591458320}},{"id":866772,"event":"call","defined_class":"Guardian","method_id":"can_enable_safe_mode?","path":"lib/guardian.rb","lineno":149,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"Guardian","object_id":70097591458320,"value":"#<Guardian:0x00007f81bc13b420>"}},{"id":866773,"event":"return","defined_class":"Guardian","method_id":"can_enable_safe_mode?","path":"lib/guardian.rb","lineno":149,"static":false,"thread_id":70097708498960,"parent_id":866772,"elapsed":1.0e-05,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":866774,"event":"return","defined_class":"ApplicationController","method_id":"resolve_safe_mode","path":"app/controllers/application_controller.rb","lineno":377,"static":false,"thread_id":70097708498960,"parent_id":866713,"elapsed":0.118637},{"id":866775,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866776,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":866775,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cb6a6838>","object_id":70097720128540}},{"id":866777,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SELECT \"user_options\".* FROM \"user_options\" WHERE \"user_options\".\"user_id\" = 1180 LIMIT 1","database_type":"postgres","server_version":110006}},{"id":866778,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866777,"elapsed":0.001026},{"id":866779,"event":"call","defined_class":"ApplicationController","method_id":"guardian","path":"app/controllers/application_controller.rb","lineno":423,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097589852080,"value":"#<UsersController:0x00007f81bbe2af60>"}},{"id":866780,"event":"return","defined_class":"ApplicationController","method_id":"guardian","path":"app/controllers/application_controller.rb","lineno":423,"static":false,"thread_id":70097708498960,"parent_id":866779,"elapsed":4.0e-06,"return_value":{"class":"Guardian","value":"#<Guardian:0x00007f81bc13b420>","object_id":70097591458320}},{"id":866781,"event":"call","defined_class":"Guardian","method_id":"allow_themes?","path":"lib/guardian.rb","lineno":474,"static":false,"thread_id":70097708498960,"parameters":[{"name":"theme_ids","class":"Array","object_id":70097592828800,"value":"[]","kind":"req"},{"name":"include_preview","class":"NilClass","object_id":8,"value":null,"kind":"key"}],"receiver":{"class":"Guardian","object_id":70097591458320,"value":"#<Guardian:0x00007f81bc13b420>"}},{"id":866782,"event":"return","defined_class":"Guardian","method_id":"allow_themes?","path":"lib/guardian.rb","lineno":474,"static":false,"thread_id":70097708498960,"parent_id":866781,"elapsed":3.0e-06,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":866783,"event":"return","defined_class":"ApplicationController","method_id":"handle_theme","path":"app/controllers/application_controller.rb","lineno":388,"static":false,"thread_id":70097708498960,"parent_id":866712,"elapsed":0.123689,"return_value":{"class":"Array","value":"[2]","object_id":70097592828800}},{"id":866784,"event":"call","defined_class":"ApplicationController","method_id":"set_current_user_for_logs","path":"app/controllers/application_controller.rb","lineno":294,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097589852080,"value":"#<UsersController:0x00007f81bbe2af60>"}},{"id":866785,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866786,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":866785,"elapsed":4.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cb6a6838>","object_id":70097720128540}},{"id":866787,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866788,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":866787,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cb6a6838>","object_id":70097720128540}},{"id":866789,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866790,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":866789,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cb6a6838>","object_id":70097720128540}},{"id":866791,"event":"return","defined_class":"ApplicationController","method_id":"set_current_user_for_logs","path":"app/controllers/application_controller.rb","lineno":294,"static":false,"thread_id":70097708498960,"parent_id":866784,"elapsed":0.000367,"return_value":{"class":"String","value":"users/create_second_factor_backup","object_id":70097592901120}},{"id":866792,"event":"call","defined_class":"ApplicationController","method_id":"clear_notifications","path":"app/controllers/application_controller.rb","lineno":302,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097589852080,"value":"#<UsersController:0x00007f81bbe2af60>"}},{"id":866793,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866794,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":866793,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cb6a6838>","object_id":70097720128540}},{"id":866795,"event":"return","defined_class":"ApplicationController","method_id":"clear_notifications","path":"app/controllers/application_controller.rb","lineno":302,"static":false,"thread_id":70097708498960,"parent_id":866792,"elapsed":0.000111},{"id":866796,"event":"call","defined_class":"ApplicationController","method_id":"set_locale","path":"app/controllers/application_controller.rb","lineno":328,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097589852080,"value":"#<UsersController:0x00007f81bbe2af60>"}},{"id":866797,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866798,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":866797,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cb6a6838>","object_id":70097720128540}},{"id":866799,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866800,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":866799,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cb6a6838>","object_id":70097720128540}},{"id":866801,"event":"call","defined_class":"User","method_id":"effective_locale","path":"app/models/user.rb","lineno":321,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"User","object_id":70097720128540,"value":"#<User:0x00007f81cb6a6838>"}},{"id":866802,"event":"return","defined_class":"User","method_id":"effective_locale","path":"app/models/user.rb","lineno":321,"static":false,"thread_id":70097708498960,"parent_id":866801,"elapsed":1.3e-05,"return_value":{"class":"String","value":"en_US","object_id":70097724286060}},{"id":866803,"event":"call","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parameters":[{"name":"locale","class":"Symbol","object_id":70097724306540,"value":"en_US","kind":"req"}],"receiver":{"class":"Class","object_id":70097569845280,"value":"LocaleSiteSetting"}},{"id":866804,"event":"return","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parent_id":866803,"elapsed":3.0e-06,"return_value":{"class":"Symbol","value":"en","object_id":3894428}},{"id":866805,"event":"call","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parameters":[{"name":"locale","class":"Symbol","object_id":3894428,"value":"en","kind":"req"}],"receiver":{"class":"Class","object_id":70097569845280,"value":"LocaleSiteSetting"}},{"id":866806,"event":"return","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parent_id":866805,"elapsed":9.0e-06},{"id":866807,"event":"call","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parameters":[{"name":"locale","class":"Symbol","object_id":70097724306540,"value":"en_US","kind":"req"}],"receiver":{"class":"Class","object_id":70097569845280,"value":"LocaleSiteSetting"}},{"id":866808,"event":"return","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parent_id":866807,"elapsed":3.0e-06,"return_value":{"class":"Symbol","value":"en","object_id":3894428}},{"id":866809,"event":"call","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parameters":[{"name":"locale","class":"Symbol","object_id":3894428,"value":"en","kind":"req"}],"receiver":{"class":"Class","object_id":70097569845280,"value":"LocaleSiteSetting"}},{"id":866810,"event":"return","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parent_id":866809,"elapsed":6.0e-06},{"id":866811,"event":"return","defined_class":"ApplicationController","method_id":"set_locale","path":"app/controllers/application_controller.rb","lineno":328,"static":false,"thread_id":70097708498960,"parent_id":866796,"elapsed":0.000695,"return_value":{"class":"Array","value":"[:en_US, :en]","object_id":70097592981880}},{"id":866812,"event":"call","defined_class":"ApplicationController","method_id":"set_mobile_view","path":"app/controllers/application_controller.rb","lineno":368,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097589852080,"value":"#<UsersController:0x00007f81bbe2af60>"}},{"id":866813,"event":"return","defined_class":"ApplicationController","method_id":"set_mobile_view","path":"app/controllers/application_controller.rb","lineno":368,"static":false,"thread_id":70097708498960,"parent_id":866812,"elapsed":7.0e-06},{"id":866814,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_api?","path":"lib/auth/default_current_user_provider.rb","lineno":271,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866815,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866816,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":866815,"elapsed":2.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cb6a6838>","object_id":70097720128540}},{"id":866817,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_api?","path":"lib/auth/default_current_user_provider.rb","lineno":271,"static":false,"thread_id":70097708498960,"parent_id":866814,"elapsed":9.2e-05},{"id":866818,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866819,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":866818,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cb6a6838>","object_id":70097720128540}},{"id":866820,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866821,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":866820,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cb6a6838>","object_id":70097720128540}},{"id":866822,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866823,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":866822,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cb6a6838>","object_id":70097720128540}},{"id":866824,"event":"call","defined_class":"ApplicationController","method_id":"requires_login_arg","path":"app/controllers/application_controller.rb","lineno":669,"static":true,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"Class","object_id":70097775906280,"value":"UsersController"}},{"id":866825,"event":"return","defined_class":"ApplicationController","method_id":"requires_login_arg","path":"app/controllers/application_controller.rb","lineno":669,"static":true,"thread_id":70097708498960,"parent_id":866824,"elapsed":4.0e-06,"return_value":{"class":"Hash","value":"{:only=>[:username, :update, :user_preferences_redirect, :upload_user_image, :pick_avatar, :destroy_","object_id":70097777085280}},{"id":866826,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866827,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":866826,"elapsed":2.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cb6a6838>","object_id":70097720128540}},{"id":866828,"event":"call","defined_class":"ApplicationController","method_id":"preload_json","path":"app/controllers/application_controller.rb","lineno":352,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097589852080,"value":"#<UsersController:0x00007f81bbe2af60>"}},{"id":866829,"event":"return","defined_class":"ApplicationController","method_id":"preload_json","path":"app/controllers/application_controller.rb","lineno":352,"static":false,"thread_id":70097708498960,"parent_id":866828,"elapsed":7.0e-06},{"id":866830,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_api?","path":"lib/auth/default_current_user_provider.rb","lineno":271,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866831,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866832,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":866831,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cb6a6838>","object_id":70097720128540}},{"id":866833,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_api?","path":"lib/auth/default_current_user_provider.rb","lineno":271,"static":false,"thread_id":70097708498960,"parent_id":866830,"elapsed":9.1e-05},{"id":866834,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_user_api?","path":"lib/auth/default_current_user_provider.rb","lineno":276,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866835,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866836,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":866835,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cb6a6838>","object_id":70097720128540}},{"id":866837,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_user_api?","path":"lib/auth/default_current_user_provider.rb","lineno":276,"static":false,"thread_id":70097708498960,"parent_id":866834,"elapsed":9.1e-05},{"id":866838,"event":"call","defined_class":"UsersController","method_id":"second_factor_check_confirmed_password","path":"app/controllers/users_controller.rb","lineno":1338,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097589852080,"value":"#<UsersController:0x00007f81bbe2af60>"}},{"id":866839,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866840,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":866839,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cb6a6838>","object_id":70097720128540}},{"id":866841,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866842,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":866841,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cb6a6838>","object_id":70097720128540}},{"id":866843,"event":"return","defined_class":"UsersController","method_id":"second_factor_check_confirmed_password","path":"app/controllers/users_controller.rb","lineno":1338,"static":false,"thread_id":70097708498960,"parent_id":866838,"elapsed":0.000282},{"id":866844,"event":"call","defined_class":"UsersController","method_id":"create_second_factor_backup","path":"app/controllers/users_controller.rb","lineno":1197,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097589852080,"value":"#<UsersController:0x00007f81bbe2af60>"}},{"id":866845,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866846,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":866845,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cb6a6838>","object_id":70097720128540}},{"id":866847,"event":"call","defined_class":"SecondFactorManager","method_id":"generate_backup_codes","path":"app/models/concerns/second_factor_manager.rb","lineno":191,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"User","object_id":70097720128540,"value":"#<User:0x00007f81cb6a6838>"}},{"id":866848,"event":"call","defined_class":"SecondFactorManager","method_id":"hash_backup_code","path":"app/models/concerns/second_factor_manager.rb","lineno":244,"static":false,"thread_id":70097708498960,"parameters":[{"name":"code","class":"String","object_id":70097593192100,"value":"2daf747fd2eeb5a40d53a75252b10036","kind":"req"},{"name":"salt","class":"String","object_id":70097593190520,"value":"7a72a24d3bcbeefd1c50081b7f3af7ec","kind":"req"}],"receiver":{"class":"User","object_id":70097720128540,"value":"#<User:0x00007f81cb6a6838>"}},{"id":866849,"event":"return","defined_class":"SecondFactorManager","method_id":"hash_backup_code","path":"app/models/concerns/second_factor_manager.rb","lineno":244,"static":false,"thread_id":70097708498960,"parent_id":866848,"elapsed":7.0e-05,"return_value":{"class":"String","value":"4fa1c94d7916ab72fed37a2bf1fc8ebf1e6f4ead1965d70beddb96b3b8ba4d1a","object_id":70097593228400}},{"id":866850,"event":"call","defined_class":"SecondFactorManager","method_id":"hash_backup_code","path":"app/models/concerns/second_factor_manager.rb","lineno":244,"static":false,"thread_id":70097708498960,"parameters":[{"name":"code","class":"String","object_id":70097593191880,"value":"e51c5c2c2ff281e3872ae6c73530183a","kind":"req"},{"name":"salt","class":"String","object_id":70097593226300,"value":"0732a01e1de705fa4534add7aee079b1","kind":"req"}],"receiver":{"class":"User","object_id":70097720128540,"value":"#<User:0x00007f81cb6a6838>"}},{"id":866851,"event":"return","defined_class":"SecondFactorManager","method_id":"hash_backup_code","path":"app/models/concerns/second_factor_manager.rb","lineno":244,"static":false,"thread_id":70097708498960,"parent_id":866850,"elapsed":5.3e-05,"return_value":{"class":"String","value":"966ff9ca3ce5c2da72ba32befdc794c49410e9d6ae44205de4784e985bfd5940","object_id":70097593258840}},{"id":866852,"event":"call","defined_class":"SecondFactorManager","method_id":"hash_backup_code","path":"app/models/concerns/second_factor_manager.rb","lineno":244,"static":false,"thread_id":70097708498960,"parameters":[{"name":"code","class":"String","object_id":70097593191780,"value":"75857b582cba56dae9f1a334efde4bf8","kind":"req"},{"name":"salt","class":"String","object_id":70097593255940,"value":"167b7f52f01c184d49126c5b21a9e25c","kind":"req"}],"receiver":{"class":"User","object_id":70097720128540,"value":"#<User:0x00007f81cb6a6838>"}},{"id":866853,"event":"return","defined_class":"SecondFactorManager","method_id":"hash_backup_code","path":"app/models/concerns/second_factor_manager.rb","lineno":244,"static":false,"thread_id":70097708498960,"parent_id":866852,"elapsed":5.3e-05,"return_value":{"class":"String","value":"ee9be2492554eef2e7778a1676c37d450dcc2b1e26116cd2bd69e5da50f446cf","object_id":70097593307880}},{"id":866854,"event":"call","defined_class":"SecondFactorManager","method_id":"hash_backup_code","path":"app/models/concerns/second_factor_manager.rb","lineno":244,"static":false,"thread_id":70097708498960,"parameters":[{"name":"code","class":"String","object_id":70097593191640,"value":"73da9987ea5f6f254541fd61a61acef1","kind":"req"},{"name":"salt","class":"String","object_id":70097593303400,"value":"3ecd342a547acaa3c6183f3134fb5db6","kind":"req"}],"receiver":{"class":"User","object_id":70097720128540,"value":"#<User:0x00007f81cb6a6838>"}},{"id":866855,"event":"return","defined_class":"SecondFactorManager","method_id":"hash_backup_code","path":"app/models/concerns/second_factor_manager.rb","lineno":244,"static":false,"thread_id":70097708498960,"parent_id":866854,"elapsed":5.5e-05,"return_value":{"class":"String","value":"e5b39e4aa3a3c3e1a059eb6569103deb4aa86ac0c97e889403f477c86ca67f1e","object_id":70097593375460}},{"id":866856,"event":"call","defined_class":"SecondFactorManager","method_id":"hash_backup_code","path":"app/models/concerns/second_factor_manager.rb","lineno":244,"static":false,"thread_id":70097708498960,"parameters":[{"name":"code","class":"String","object_id":70097593191480,"value":"e0b119e665433158fcacbff8a6dca988","kind":"req"},{"name":"salt","class":"String","object_id":70097593369060,"value":"ebc270466ab53bff054256985528e13d","kind":"req"}],"receiver":{"class":"User","object_id":70097720128540,"value":"#<User:0x00007f81cb6a6838>"}},{"id":866857,"event":"return","defined_class":"SecondFactorManager","method_id":"hash_backup_code","path":"app/models/concerns/second_factor_manager.rb","lineno":244,"static":false,"thread_id":70097708498960,"parent_id":866856,"elapsed":5.1e-05,"return_value":{"class":"String","value":"b7b7128ba843a26a643937d02cdfe7acd554c56eb256686ffb958594facd2a29","object_id":70097593436300}},{"id":866858,"event":"call","defined_class":"SecondFactorManager","method_id":"hash_backup_code","path":"app/models/concerns/second_factor_manager.rb","lineno":244,"static":false,"thread_id":70097708498960,"parameters":[{"name":"code","class":"String","object_id":70097593191380,"value":"1306e827f85bb7d1aa9dbd4129db0321","kind":"req"},{"name":"salt","class":"String","object_id":70097593458140,"value":"1aead706a3beaad9a9d813335237ecca","kind":"req"}],"receiver":{"class":"User","object_id":70097720128540,"value":"#<User:0x00007f81cb6a6838>"}},{"id":866859,"event":"return","defined_class":"SecondFactorManager","method_id":"hash_backup_code","path":"app/models/concerns/second_factor_manager.rb","lineno":244,"static":false,"thread_id":70097708498960,"parent_id":866858,"elapsed":5.7e-05,"return_value":{"class":"String","value":"630a043444f5ac00804d7ffb7756cf6e0fc008eec4ac2691a3c7b6ea50481ea1","object_id":70097593488880}},{"id":866860,"event":"call","defined_class":"SecondFactorManager","method_id":"hash_backup_code","path":"app/models/concerns/second_factor_manager.rb","lineno":244,"static":false,"thread_id":70097708498960,"parameters":[{"name":"code","class":"String","object_id":70097593191240,"value":"036719e4a390694ae973da9dd7078f3a","kind":"req"},{"name":"salt","class":"String","object_id":70097593485200,"value":"c5edf9154e87762c4b369742aa0d6af9","kind":"req"}],"receiver":{"class":"User","object_id":70097720128540,"value":"#<User:0x00007f81cb6a6838>"}},{"id":866861,"event":"return","defined_class":"SecondFactorManager","method_id":"hash_backup_code","path":"app/models/concerns/second_factor_manager.rb","lineno":244,"static":false,"thread_id":70097708498960,"parent_id":866860,"elapsed":5.0e-05,"return_value":{"class":"String","value":"362e26cd04c7e485eab12e795d810709f8a0984812daafe19be671d02de1a8b2","object_id":70097593520440}},{"id":866862,"event":"call","defined_class":"SecondFactorManager","method_id":"hash_backup_code","path":"app/models/concerns/second_factor_manager.rb","lineno":244,"static":false,"thread_id":70097708498960,"parameters":[{"name":"code","class":"String","object_id":70097593191060,"value":"d30b52d0541ebf01e031bff8739c9f09","kind":"req"},{"name":"salt","class":"String","object_id":70097593516600,"value":"71ef1f32a36ce65c9c9d6c7d61ddda49","kind":"req"}],"receiver":{"class":"User","object_id":70097720128540,"value":"#<User:0x00007f81cb6a6838>"}},{"id":866863,"event":"return","defined_class":"SecondFactorManager","method_id":"hash_backup_code","path":"app/models/concerns/second_factor_manager.rb","lineno":244,"static":false,"thread_id":70097708498960,"parent_id":866862,"elapsed":5.4e-05,"return_value":{"class":"String","value":"ca10167f12f13432b3f707d9ab16aa68a50d90ae8674f332aa76e4f54a588334","object_id":70097593570740}},{"id":866864,"event":"call","defined_class":"SecondFactorManager","method_id":"hash_backup_code","path":"app/models/concerns/second_factor_manager.rb","lineno":244,"static":false,"thread_id":70097708498960,"parameters":[{"name":"code","class":"String","object_id":70097593190920,"value":"ac39654de9f73b7a2dcf44dcf3e3320a","kind":"req"},{"name":"salt","class":"String","object_id":70097593568840,"value":"58933072e7222c58e3ba1cd3523ffe56","kind":"req"}],"receiver":{"class":"User","object_id":70097720128540,"value":"#<User:0x00007f81cb6a6838>"}},{"id":866865,"event":"return","defined_class":"SecondFactorManager","method_id":"hash_backup_code","path":"app/models/concerns/second_factor_manager.rb","lineno":244,"static":false,"thread_id":70097708498960,"parent_id":866864,"elapsed":5.3e-05,"return_value":{"class":"String","value":"469a69fd9c7461d2e763f740af1872005f3748586eb0ad7ad7da6e116c38bf5e","object_id":70097593601840}},{"id":866866,"event":"call","defined_class":"SecondFactorManager","method_id":"hash_backup_code","path":"app/models/concerns/second_factor_manager.rb","lineno":244,"static":false,"thread_id":70097708498960,"parameters":[{"name":"code","class":"String","object_id":70097593190820,"value":"32e2dee9f10ec8fbf284f4bc9ed8ba22","kind":"req"},{"name":"salt","class":"String","object_id":70097593598720,"value":"9f5428079a234049086932e6514c4824","kind":"req"}],"receiver":{"class":"User","object_id":70097720128540,"value":"#<User:0x00007f81cb6a6838>"}},{"id":866867,"event":"return","defined_class":"SecondFactorManager","method_id":"hash_backup_code","path":"app/models/concerns/second_factor_manager.rb","lineno":244,"static":false,"thread_id":70097708498960,"parent_id":866866,"elapsed":5.4e-05,"return_value":{"class":"String","value":"ceac27f12f28a82e23de82977e2889b69b2997065fe40e340b520c6aedf0f3e2","object_id":70097593652780}},{"id":866868,"event":"call","defined_class":"UserSecondFactor(id: integer, user_id: integer, method: integer, data: string, enabled: boolean, last_used: datetime, created_at: datetime, updated_at: datetime, name: string)","method_id":"methods","path":"app/models/user_second_factor.rb","lineno":19,"static":true,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"Class","object_id":70097779296820,"value":"UserSecondFactor"}},{"id":866869,"event":"return","defined_class":"UserSecondFactor(id: integer, user_id: integer, method: integer, data: string, enabled: boolean, last_used: datetime, created_at: datetime, updated_at: datetime, name: string)","method_id":"methods","path":"app/models/user_second_factor.rb","lineno":19,"static":true,"thread_id":70097708498960,"parent_id":866868,"elapsed":4.0e-06,"return_value":{"class":"Enum","value":"{:totp=>1, :backup_codes=>2, :security_key=>3}","object_id":70097755302300}},{"id":866870,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SELECT 1 AS one FROM \"user_second_factors\" WHERE \"user_second_factors\".\"user_id\" = 1180 AND \"user_second_factors\".\"method\" = 2 AND \"user_second_factors\".\"enabled\" = TRUE LIMIT 1","database_type":"postgres","server_version":110006}},{"id":866871,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866870,"elapsed":0.000997},{"id":866872,"event":"call","defined_class":"SecondFactorManager","method_id":"create_backup_codes","path":"app/models/concerns/second_factor_manager.rb","lineno":214,"static":false,"thread_id":70097708498960,"parameters":[{"name":"codes","class":"Array","object_id":70097593190740,"value":"[{:salt=>\"7a72a24d3bcbeefd1c50081b7f3af7ec\", :code_hash=>\"4fa1c94d7916ab72fed37a2bf1fc8ebf1e6f4ead19","kind":"req"}],"receiver":{"class":"User","object_id":70097720128540,"value":"#<User:0x00007f81cb6a6838>"}},{"id":866873,"event":"call","defined_class":"UserSecondFactor(id: integer, user_id: integer, method: integer, data: string, enabled: boolean, last_used: datetime, created_at: datetime, updated_at: datetime, name: string)","method_id":"methods","path":"app/models/user_second_factor.rb","lineno":19,"static":true,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"Class","object_id":70097779296820,"value":"UserSecondFactor"}},{"id":866874,"event":"return","defined_class":"UserSecondFactor(id: integer, user_id: integer, method: integer, data: string, enabled: boolean, last_used: datetime, created_at: datetime, updated_at: datetime, name: string)","method_id":"methods","path":"app/models/user_second_factor.rb","lineno":19,"static":true,"thread_id":70097708498960,"parent_id":866873,"elapsed":4.0e-06,"return_value":{"class":"Enum","value":"{:totp=>1, :backup_codes=>2, :security_key=>3}","object_id":70097755302300}},{"id":866875,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":866876,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866875,"elapsed":0.000767},{"id":866877,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"INSERT INTO \"user_second_factors\" (\"user_id\", \"method\", \"data\", \"enabled\", \"created_at\", \"updated_at\") VALUES (1180, 2, '{\"salt\":\"7a72a24d3bcbeefd1c50081b7f3af7ec\",\"code_hash\":\"4fa1c94d7916ab72fed37a2bf1fc8ebf1e6f4ead1965d70beddb96b3b8ba4d1a\"}', TRUE, '2020-05-28 18:59:43.826879', '2020-05-28 18:59:43.826879') RETURNING \"id\"","database_type":"postgres","server_version":110006}},{"id":866878,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866877,"elapsed":0.000982},{"id":866879,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"RELEASE SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":866880,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866879,"elapsed":0.000763},{"id":866881,"event":"call","defined_class":"UserSecondFactor(id: integer, user_id: integer, method: integer, data: string, enabled: boolean, last_used: datetime, created_at: datetime, updated_at: datetime, name: string)","method_id":"methods","path":"app/models/user_second_factor.rb","lineno":19,"static":true,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"Class","object_id":70097779296820,"value":"UserSecondFactor"}},{"id":866882,"event":"return","defined_class":"UserSecondFactor(id: integer, user_id: integer, method: integer, data: string, enabled: boolean, last_used: datetime, created_at: datetime, updated_at: datetime, name: string)","method_id":"methods","path":"app/models/user_second_factor.rb","lineno":19,"static":true,"thread_id":70097708498960,"parent_id":866881,"elapsed":5.0e-06,"return_value":{"class":"Enum","value":"{:totp=>1, :backup_codes=>2, :security_key=>3}","object_id":70097755302300}},{"id":866883,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":866884,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866883,"elapsed":0.000783},{"id":866885,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"INSERT INTO \"user_second_factors\" (\"user_id\", \"method\", \"data\", \"enabled\", \"created_at\", \"updated_at\") VALUES (1180, 2, '{\"salt\":\"0732a01e1de705fa4534add7aee079b1\",\"code_hash\":\"966ff9ca3ce5c2da72ba32befdc794c49410e9d6ae44205de4784e985bfd5940\"}', TRUE, '2020-05-28 18:59:43.839109', '2020-05-28 18:59:43.839109') RETURNING \"id\"","database_type":"postgres","server_version":110006}},{"id":866886,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866885,"elapsed":0.001088},{"id":866887,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"RELEASE SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":866888,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866887,"elapsed":0.00091},{"id":866889,"event":"call","defined_class":"UserSecondFactor(id: integer, user_id: integer, method: integer, data: string, enabled: boolean, last_used: datetime, created_at: datetime, updated_at: datetime, name: string)","method_id":"methods","path":"app/models/user_second_factor.rb","lineno":19,"static":true,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"Class","object_id":70097779296820,"value":"UserSecondFactor"}},{"id":866890,"event":"return","defined_class":"UserSecondFactor(id: integer, user_id: integer, method: integer, data: string, enabled: boolean, last_used: datetime, created_at: datetime, updated_at: datetime, name: string)","method_id":"methods","path":"app/models/user_second_factor.rb","lineno":19,"static":true,"thread_id":70097708498960,"parent_id":866889,"elapsed":5.0e-06,"return_value":{"class":"Enum","value":"{:totp=>1, :backup_codes=>2, :security_key=>3}","object_id":70097755302300}},{"id":866891,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":866892,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866891,"elapsed":0.000725},{"id":866893,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"INSERT INTO \"user_second_factors\" (\"user_id\", \"method\", \"data\", \"enabled\", \"created_at\", \"updated_at\") VALUES (1180, 2, '{\"salt\":\"167b7f52f01c184d49126c5b21a9e25c\",\"code_hash\":\"ee9be2492554eef2e7778a1676c37d450dcc2b1e26116cd2bd69e5da50f446cf\"}', TRUE, '2020-05-28 18:59:43.851219', '2020-05-28 18:59:43.851219') RETURNING \"id\"","database_type":"postgres","server_version":110006}},{"id":866894,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866893,"elapsed":0.000989},{"id":866895,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"RELEASE SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":866896,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866895,"elapsed":0.000759},{"id":866897,"event":"call","defined_class":"UserSecondFactor(id: integer, user_id: integer, method: integer, data: string, enabled: boolean, last_used: datetime, created_at: datetime, updated_at: datetime, name: string)","method_id":"methods","path":"app/models/user_second_factor.rb","lineno":19,"static":true,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"Class","object_id":70097779296820,"value":"UserSecondFactor"}},{"id":866898,"event":"return","defined_class":"UserSecondFactor(id: integer, user_id: integer, method: integer, data: string, enabled: boolean, last_used: datetime, created_at: datetime, updated_at: datetime, name: string)","method_id":"methods","path":"app/models/user_second_factor.rb","lineno":19,"static":true,"thread_id":70097708498960,"parent_id":866897,"elapsed":5.0e-06,"return_value":{"class":"Enum","value":"{:totp=>1, :backup_codes=>2, :security_key=>3}","object_id":70097755302300}},{"id":866899,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":866900,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866899,"elapsed":0.000598},{"id":866901,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"INSERT INTO \"user_second_factors\" (\"user_id\", \"method\", \"data\", \"enabled\", \"created_at\", \"updated_at\") VALUES (1180, 2, '{\"salt\":\"3ecd342a547acaa3c6183f3134fb5db6\",\"code_hash\":\"e5b39e4aa3a3c3e1a059eb6569103deb4aa86ac0c97e889403f477c86ca67f1e\"}', TRUE, '2020-05-28 18:59:43.862847', '2020-05-28 18:59:43.862847') RETURNING \"id\"","database_type":"postgres","server_version":110006}},{"id":866902,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866901,"elapsed":0.00089},{"id":866903,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"RELEASE SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":866904,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866903,"elapsed":0.000752},{"id":866905,"event":"call","defined_class":"UserSecondFactor(id: integer, user_id: integer, method: integer, data: string, enabled: boolean, last_used: datetime, created_at: datetime, updated_at: datetime, name: string)","method_id":"methods","path":"app/models/user_second_factor.rb","lineno":19,"static":true,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"Class","object_id":70097779296820,"value":"UserSecondFactor"}},{"id":866906,"event":"return","defined_class":"UserSecondFactor(id: integer, user_id: integer, method: integer, data: string, enabled: boolean, last_used: datetime, created_at: datetime, updated_at: datetime, name: string)","method_id":"methods","path":"app/models/user_second_factor.rb","lineno":19,"static":true,"thread_id":70097708498960,"parent_id":866905,"elapsed":5.0e-06,"return_value":{"class":"Enum","value":"{:totp=>1, :backup_codes=>2, :security_key=>3}","object_id":70097755302300}},{"id":866907,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":866908,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866907,"elapsed":0.000742},{"id":866909,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"INSERT INTO \"user_second_factors\" (\"user_id\", \"method\", \"data\", \"enabled\", \"created_at\", \"updated_at\") VALUES (1180, 2, '{\"salt\":\"ebc270466ab53bff054256985528e13d\",\"code_hash\":\"b7b7128ba843a26a643937d02cdfe7acd554c56eb256686ffb958594facd2a29\"}', TRUE, '2020-05-28 18:59:43.874247', '2020-05-28 18:59:43.874247') RETURNING \"id\"","database_type":"postgres","server_version":110006}},{"id":866910,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866909,"elapsed":0.00093},{"id":866911,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"RELEASE SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":866912,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866911,"elapsed":0.000709},{"id":866913,"event":"call","defined_class":"UserSecondFactor(id: integer, user_id: integer, method: integer, data: string, enabled: boolean, last_used: datetime, created_at: datetime, updated_at: datetime, name: string)","method_id":"methods","path":"app/models/user_second_factor.rb","lineno":19,"static":true,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"Class","object_id":70097779296820,"value":"UserSecondFactor"}},{"id":866914,"event":"return","defined_class":"UserSecondFactor(id: integer, user_id: integer, method: integer, data: string, enabled: boolean, last_used: datetime, created_at: datetime, updated_at: datetime, name: string)","method_id":"methods","path":"app/models/user_second_factor.rb","lineno":19,"static":true,"thread_id":70097708498960,"parent_id":866913,"elapsed":5.0e-06,"return_value":{"class":"Enum","value":"{:totp=>1, :backup_codes=>2, :security_key=>3}","object_id":70097755302300}},{"id":866915,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":866916,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866915,"elapsed":0.000759},{"id":866917,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"INSERT INTO \"user_second_factors\" (\"user_id\", \"method\", \"data\", \"enabled\", \"created_at\", \"updated_at\") VALUES (1180, 2, '{\"salt\":\"1aead706a3beaad9a9d813335237ecca\",\"code_hash\":\"630a043444f5ac00804d7ffb7756cf6e0fc008eec4ac2691a3c7b6ea50481ea1\"}', TRUE, '2020-05-28 18:59:43.885949', '2020-05-28 18:59:43.885949') RETURNING \"id\"","database_type":"postgres","server_version":110006}},{"id":866918,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866917,"elapsed":0.000957},{"id":866919,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"RELEASE SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":866920,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866919,"elapsed":0.000873},{"id":866921,"event":"call","defined_class":"UserSecondFactor(id: integer, user_id: integer, method: integer, data: string, enabled: boolean, last_used: datetime, created_at: datetime, updated_at: datetime, name: string)","method_id":"methods","path":"app/models/user_second_factor.rb","lineno":19,"static":true,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"Class","object_id":70097779296820,"value":"UserSecondFactor"}},{"id":866922,"event":"return","defined_class":"UserSecondFactor(id: integer, user_id: integer, method: integer, data: string, enabled: boolean, last_used: datetime, created_at: datetime, updated_at: datetime, name: string)","method_id":"methods","path":"app/models/user_second_factor.rb","lineno":19,"static":true,"thread_id":70097708498960,"parent_id":866921,"elapsed":5.0e-06,"return_value":{"class":"Enum","value":"{:totp=>1, :backup_codes=>2, :security_key=>3}","object_id":70097755302300}},{"id":866923,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":866924,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866923,"elapsed":0.000729},{"id":866925,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"INSERT INTO \"user_second_factors\" (\"user_id\", \"method\", \"data\", \"enabled\", \"created_at\", \"updated_at\") VALUES (1180, 2, '{\"salt\":\"c5edf9154e87762c4b369742aa0d6af9\",\"code_hash\":\"362e26cd04c7e485eab12e795d810709f8a0984812daafe19be671d02de1a8b2\"}', TRUE, '2020-05-28 18:59:43.897943', '2020-05-28 18:59:43.897943') RETURNING \"id\"","database_type":"postgres","server_version":110006}},{"id":866926,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866925,"elapsed":0.000908},{"id":866927,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"RELEASE SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":866928,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866927,"elapsed":0.000788},{"id":866929,"event":"call","defined_class":"UserSecondFactor(id: integer, user_id: integer, method: integer, data: string, enabled: boolean, last_used: datetime, created_at: datetime, updated_at: datetime, name: string)","method_id":"methods","path":"app/models/user_second_factor.rb","lineno":19,"static":true,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"Class","object_id":70097779296820,"value":"UserSecondFactor"}},{"id":866930,"event":"return","defined_class":"UserSecondFactor(id: integer, user_id: integer, method: integer, data: string, enabled: boolean, last_used: datetime, created_at: datetime, updated_at: datetime, name: string)","method_id":"methods","path":"app/models/user_second_factor.rb","lineno":19,"static":true,"thread_id":70097708498960,"parent_id":866929,"elapsed":5.0e-06,"return_value":{"class":"Enum","value":"{:totp=>1, :backup_codes=>2, :security_key=>3}","object_id":70097755302300}},{"id":866931,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":866932,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866931,"elapsed":0.000716},{"id":866933,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"INSERT INTO \"user_second_factors\" (\"user_id\", \"method\", \"data\", \"enabled\", \"created_at\", \"updated_at\") VALUES (1180, 2, '{\"salt\":\"71ef1f32a36ce65c9c9d6c7d61ddda49\",\"code_hash\":\"ca10167f12f13432b3f707d9ab16aa68a50d90ae8674f332aa76e4f54a588334\"}', TRUE, '2020-05-28 18:59:43.909414', '2020-05-28 18:59:43.909414') RETURNING \"id\"","database_type":"postgres","server_version":110006}},{"id":866934,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866933,"elapsed":0.000942},{"id":866935,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"RELEASE SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":866936,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866935,"elapsed":0.000643},{"id":866937,"event":"call","defined_class":"UserSecondFactor(id: integer, user_id: integer, method: integer, data: string, enabled: boolean, last_used: datetime, created_at: datetime, updated_at: datetime, name: string)","method_id":"methods","path":"app/models/user_second_factor.rb","lineno":19,"static":true,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"Class","object_id":70097779296820,"value":"UserSecondFactor"}},{"id":866938,"event":"return","defined_class":"UserSecondFactor(id: integer, user_id: integer, method: integer, data: string, enabled: boolean, last_used: datetime, created_at: datetime, updated_at: datetime, name: string)","method_id":"methods","path":"app/models/user_second_factor.rb","lineno":19,"static":true,"thread_id":70097708498960,"parent_id":866937,"elapsed":6.0e-06,"return_value":{"class":"Enum","value":"{:totp=>1, :backup_codes=>2, :security_key=>3}","object_id":70097755302300}},{"id":866939,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":866940,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866939,"elapsed":0.001221},{"id":866941,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"INSERT INTO \"user_second_factors\" (\"user_id\", \"method\", \"data\", \"enabled\", \"created_at\", \"updated_at\") VALUES (1180, 2, '{\"salt\":\"58933072e7222c58e3ba1cd3523ffe56\",\"code_hash\":\"469a69fd9c7461d2e763f740af1872005f3748586eb0ad7ad7da6e116c38bf5e\"}', TRUE, '2020-05-28 18:59:43.960732', '2020-05-28 18:59:43.960732') RETURNING \"id\"","database_type":"postgres","server_version":110006}},{"id":866942,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866941,"elapsed":0.001008},{"id":866943,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"RELEASE SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":866944,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866943,"elapsed":0.000863},{"id":866945,"event":"call","defined_class":"UserSecondFactor(id: integer, user_id: integer, method: integer, data: string, enabled: boolean, last_used: datetime, created_at: datetime, updated_at: datetime, name: string)","method_id":"methods","path":"app/models/user_second_factor.rb","lineno":19,"static":true,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"Class","object_id":70097779296820,"value":"UserSecondFactor"}},{"id":866946,"event":"return","defined_class":"UserSecondFactor(id: integer, user_id: integer, method: integer, data: string, enabled: boolean, last_used: datetime, created_at: datetime, updated_at: datetime, name: string)","method_id":"methods","path":"app/models/user_second_factor.rb","lineno":19,"static":true,"thread_id":70097708498960,"parent_id":866945,"elapsed":7.0e-06,"return_value":{"class":"Enum","value":"{:totp=>1, :backup_codes=>2, :security_key=>3}","object_id":70097755302300}},{"id":866947,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":866948,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866947,"elapsed":0.000838},{"id":866949,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"INSERT INTO \"user_second_factors\" (\"user_id\", \"method\", \"data\", \"enabled\", \"created_at\", \"updated_at\") VALUES (1180, 2, '{\"salt\":\"9f5428079a234049086932e6514c4824\",\"code_hash\":\"ceac27f12f28a82e23de82977e2889b69b2997065fe40e340b520c6aedf0f3e2\"}', TRUE, '2020-05-28 18:59:43.976013', '2020-05-28 18:59:43.976013') RETURNING \"id\"","database_type":"postgres","server_version":110006}},{"id":866950,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866949,"elapsed":0.001077},{"id":866951,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"RELEASE SAVEPOINT active_record_1","database_type":"postgres","server_version":110006}},{"id":866952,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":866951,"elapsed":0.000924},{"id":866953,"event":"return","defined_class":"SecondFactorManager","method_id":"create_backup_codes","path":"app/models/concerns/second_factor_manager.rb","lineno":214,"static":false,"thread_id":70097708498960,"parent_id":866872,"elapsed":0.162234,"return_value":{"class":"Array","value":"[{:salt=>\"7a72a24d3bcbeefd1c50081b7f3af7ec\", :code_hash=>\"4fa1c94d7916ab72fed37a2bf1fc8ebf1e6f4ead19","object_id":70097593190740}},{"id":866954,"event":"return","defined_class":"SecondFactorManager","method_id":"generate_backup_codes","path":"app/models/concerns/second_factor_manager.rb","lineno":191,"static":false,"thread_id":70097708498960,"parent_id":866847,"elapsed":0.168709,"return_value":{"class":"Array","value":"[\"2daf747fd2eeb5a40d53a75252b10036\", \"e51c5c2c2ff281e3872ae6c73530183a\", \"75857b582cba56dae9f1a334ef","object_id":70097593192260}},{"id":866955,"event":"return","defined_class":"UsersController","method_id":"create_second_factor_backup","path":"app/controllers/users_controller.rb","lineno":1197,"static":false,"thread_id":70097708498960,"parent_id":866844,"elapsed":0.169163,"return_value":{"class":"String","value":"{\"success\":\"OK\",\"backup_codes\":[\"2daf747fd2eeb5a40d53a75252b10036\",\"e51c5c2c2ff281e3872ae6c73530183a","object_id":70097795672120}},{"id":866956,"event":"call","defined_class":"ApplicationController","method_id":"conditionally_allow_site_embedding","path":"app/controllers/application_controller.rb","lineno":92,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097589852080,"value":"#<UsersController:0x00007f81bbe2af60>"}},{"id":866957,"event":"return","defined_class":"ApplicationController","method_id":"conditionally_allow_site_embedding","path":"app/controllers/application_controller.rb","lineno":92,"static":false,"thread_id":70097708498960,"parent_id":866956,"elapsed":8.0e-06},{"id":866958,"event":"call","defined_class":"ApplicationController","method_id":"dont_cache_page","path":"app/controllers/application_controller.rb","lineno":85,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097589852080,"value":"#<UsersController:0x00007f81bbe2af60>"}},{"id":866959,"event":"return","defined_class":"ApplicationController","method_id":"dont_cache_page","path":"app/controllers/application_controller.rb","lineno":85,"static":false,"thread_id":70097708498960,"parent_id":866958,"elapsed":6.0e-06,"return_value":{"class":"Array","value":"[\"no-store\"]","object_id":70097795400580}},{"id":866960,"event":"call","defined_class":"ApplicationController","method_id":"perform_refresh_session","path":"app/controllers/application_controller.rb","lineno":75,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"UsersController","object_id":70097589852080,"value":"#<UsersController:0x00007f81bbe2af60>"}},{"id":866961,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866962,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":866961,"elapsed":4.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cb6a6838>","object_id":70097720128540}},{"id":866963,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"refresh_session","path":"lib/auth/default_current_user_provider.rb","lineno":173,"static":false,"thread_id":70097708498960,"parameters":[{"name":"user","class":"User","object_id":70097720128540,"value":"#<User:0x00007f81cb6a6838>","kind":"req"},{"name":"session","class":"ActionDispatch::Request::Session","object_id":70097589782600,"value":"#<ActionDispatch::Request::Session:0x00007f81bbe09090>","kind":"req"},{"name":"cookies","class":"ActionDispatch::Cookies::CookieJar","object_id":70097592829200,"value":"#<ActionDispatch::Cookies::CookieJar:0x00007f81bc3d8a20>","kind":"req"}],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866964,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_api?","path":"lib/auth/default_current_user_provider.rb","lineno":271,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866965,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866966,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":866965,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cb6a6838>","object_id":70097720128540}},{"id":866967,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_api?","path":"lib/auth/default_current_user_provider.rb","lineno":271,"static":false,"thread_id":70097708498960,"parent_id":866964,"elapsed":9.1e-05},{"id":866968,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_user_api?","path":"lib/auth/default_current_user_provider.rb","lineno":276,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866969,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097589864280,"value":"#<TestCurrentUserProvider:0x00007f81bbe30eb0>"}},{"id":866970,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":866969,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81cb6a6838>","object_id":70097720128540}},{"id":866971,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_user_api?","path":"lib/auth/default_current_user_provider.rb","lineno":276,"static":false,"thread_id":70097708498960,"parent_id":866968,"elapsed":8.9e-05},{"id":866972,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"refresh_session","path":"lib/auth/default_current_user_provider.rb","lineno":173,"static":false,"thread_id":70097708498960,"parent_id":866963,"elapsed":0.000408},{"id":866973,"event":"return","defined_class":"ApplicationController","method_id":"perform_refresh_session","path":"app/controllers/application_controller.rb","lineno":75,"static":false,"thread_id":70097708498960,"parent_id":866960,"elapsed":0.00062},{"id":866974,"event":"return","defined_class":"AppMap::Rails::ActionHandler::HTTPServerResponse","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/action_handler.rb","lineno":85,"static":false,"thread_id":70097708498960,"parent_id":866711,"elapsed":0.298265,"http_server_response":{"status":200}},{"id":866975,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"has_auth_cookie?","path":"lib/auth/default_current_user_provider.rb","lineno":281,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097795726480,"value":"#<TestCurrentUserProvider:0x00007f81d46d7920>"}},{"id":866976,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"has_auth_cookie?","path":"lib/auth/default_current_user_provider.rb","lineno":281,"static":false,"thread_id":70097708498960,"parent_id":866975,"elapsed":7.0e-06,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":866977,"event":"call","defined_class":"ApplicationRequest(id: integer, date: date, req_type: integer, count: integer)","method_id":"increment!","path":"app/models/application_request.rb","lineno":26,"static":true,"thread_id":70097708498960,"parameters":[{"name":"type","class":"Symbol","object_id":13040028,"value":"http_total","kind":"req"},{"name":"opts","class":"NilClass","object_id":8,"value":null,"kind":"opt"}],"receiver":{"class":"Class","object_id":70097802320860,"value":"ApplicationRequest"}},{"id":866978,"event":"return","defined_class":"ApplicationRequest(id: integer, date: date, req_type: integer, count: integer)","method_id":"increment!","path":"app/models/application_request.rb","lineno":26,"static":true,"thread_id":70097708498960,"parent_id":866977,"elapsed":6.0e-06},{"id":866979,"event":"call","defined_class":"ApplicationRequest(id: integer, date: date, req_type: integer, count: integer)","method_id":"increment!","path":"app/models/application_request.rb","lineno":26,"static":true,"thread_id":70097708498960,"parameters":[{"name":"type","class":"Symbol","object_id":13041948,"value":"http_2xx","kind":"req"},{"name":"opts","class":"NilClass","object_id":8,"value":null,"kind":"opt"}],"receiver":{"class":"Class","object_id":70097802320860,"value":"ApplicationRequest"}},{"id":866980,"event":"return","defined_class":"ApplicationRequest(id: integer, date: date, req_type: integer, count: integer)","method_id":"increment!","path":"app/models/application_request.rb","lineno":26,"static":true,"thread_id":70097708498960,"parent_id":866979,"elapsed":4.0e-06}]}