{"version":"1.2","metadata":{"language":{"name":"ruby","engine":"ruby","version":"2.6.2"},"client":{"name":"appmap","url":"https://github.com/applandinc/appmap-ruby","version":"0.26.1"},"frameworks":[{"name":"rails","version":"6.0.3.1"},{"name":"rspec","version":"3.9.2"}],"git":{"repository":"git@github.com:applandinc/discourse.git","branch":"master","commit":"32fd4b3aab495794a8b45d85fb5cca2201161e3c","status":["M Gemfile.lock","M config/initializers/150-appmap.rb","D spec/requests/posts_controller_spec.rb","M spec/requests/user_actions_controller_spec.rb","M spec/requests/users_controller_spec.rb"],"git_last_annotated_tag":"v2.5.0.beta5","git_last_tag":"v2.5.0.beta5","git_commits_since_last_annotated_tag":0,"git_commits_since_last_tag":0},"name":"EmailController #preferences_redirect when logged in redirects to your user preferences","app":"Discourse","feature":"EmailController #preferences_redirect","feature_group":"Email","recorder":{"name":"rspec"}},"classMap":[{"name":"app/models","type":"package","children":[{"name":"LocaleSiteSetting","type":"class","children":[{"name":"fallback_locale","type":"function","location":"app/models/locale_site_setting.rb:62","static":true}]},{"name":"UserAuthToken(id: integer, user_id: integer, auth_token: string, prev_auth_token: string, user_agent: string, auth_token_seen: boolean, client_ip: inet, rotated_at: datetime, created_at: datetime, updated_at: datetime, seen_at: datetime)","type":"class","children":[{"name":"lookup","type":"function","location":"app/models/user_auth_token.rb:99","static":true},{"name":"hash_token","type":"function","location":"app/models/user_auth_token.rb:164","static":true},{"name":"log","type":"function","location":"app/models/user_auth_token.rb:26","static":true}]},{"name":"GlobalSetting","type":"class","children":[{"name":"safe_secret_key_base","type":"function","location":"app/models/global_setting.rb:25","static":true}]},{"name":"User","type":"class","children":[{"name":"suspended?","type":"function","location":"app/models/user.rb:869","static":false},{"name":"update_last_seen!","type":"function","location":"app/models/user.rb:721","static":false},{"name":"update_visit_record!","type":"function","location":"app/models/user.rb:680","static":false},{"name":"visit_record_for","type":"function","location":"app/models/user.rb:676","static":false},{"name":"create_visit_record!","type":"function","location":"app/models/user.rb:671","static":false},{"name":"seen_before?","type":"function","location":"app/models/user.rb:667","static":false},{"name":"update_ip_address!","type":"function","location":"app/models/user.rb:715","static":false},{"name":"effective_locale","type":"function","location":"app/models/user.rb:321","static":false}]},{"name":"Theme(id: integer, name: string, user_id: integer, created_at: datetime, updated_at: datetime, compiler_version: integer, user_selectable: boolean, hidden: boolean, color_scheme_id: integer, remote_theme_id: integer, component: boolean, enabled: boolean)","type":"class","children":[{"name":"transform_ids","type":"function","location":"app/models/theme.rb:162","static":true},{"name":"get_set_cache","type":"function","location":"app/models/theme.rb:125","static":true}]},{"name":"ApplicationRequest(id: integer, date: date, req_type: integer, count: integer)","type":"class","children":[{"name":"increment!","type":"function","location":"app/models/application_request.rb:26","static":true}]}]},{"name":"app/controllers","type":"package","children":[{"name":"ApplicationController","type":"class","children":[{"name":"handle_theme","type":"function","location":"app/controllers/application_controller.rb:388","static":false},{"name":"resolve_safe_mode","type":"function","location":"app/controllers/application_controller.rb:377","static":false},{"name":"guardian","type":"function","location":"app/controllers/application_controller.rb:423","static":false},{"name":"set_current_user_for_logs","type":"function","location":"app/controllers/application_controller.rb:294","static":false},{"name":"clear_notifications","type":"function","location":"app/controllers/application_controller.rb:302","static":false},{"name":"set_locale","type":"function","location":"app/controllers/application_controller.rb:328","static":false},{"name":"set_mobile_view","type":"function","location":"app/controllers/application_controller.rb:368","static":false},{"name":"requires_login_arg","type":"function","location":"app/controllers/application_controller.rb:669","static":true},{"name":"conditionally_allow_site_embedding","type":"function","location":"app/controllers/application_controller.rb:92","static":false},{"name":"dont_cache_page","type":"function","location":"app/controllers/application_controller.rb:85","static":false},{"name":"perform_refresh_session","type":"function","location":"app/controllers/application_controller.rb:75","static":false}]},{"name":"EmailController","type":"class","children":[{"name":"preferences_redirect","type":"function","location":"app/controllers/email_controller.rb:9","static":false}]}]},{"name":"lib/auth","type":"package","children":[{"name":"Auth","type":"class","children":[{"name":"DefaultCurrentUserProvider","type":"class","children":[{"name":"current_user","type":"function","location":"lib/auth/default_current_user_provider.rb:61","static":false},{"name":"should_update_last_seen?","type":"function","location":"lib/auth/default_current_user_provider.rb:286","static":false},{"name":"refresh_session","type":"function","location":"lib/auth/default_current_user_provider.rb:173","static":false},{"name":"is_api?","type":"function","location":"lib/auth/default_current_user_provider.rb:271","static":false},{"name":"is_user_api?","type":"function","location":"lib/auth/default_current_user_provider.rb:276","static":false},{"name":"has_auth_cookie?","type":"function","location":"lib/auth/default_current_user_provider.rb:281","static":false}]}]}]},{"name":"lib/guardian","type":"package","children":[{"name":"Guardian","type":"class","children":[{"name":"can_enable_safe_mode?","type":"function","location":"lib/guardian.rb:149","static":false},{"name":"allow_themes?","type":"function","location":"lib/guardian.rb:474","static":false}]}]}],"events":[{"id":716129,"event":"call","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parameters":[{"name":"locale","class":"Symbol","object_id":70097724306540,"value":"en_US","kind":"req"}],"receiver":{"class":"Class","object_id":70097569845280,"value":"LocaleSiteSetting"}},{"id":716130,"event":"return","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parent_id":716129,"elapsed":7.0e-06,"return_value":{"class":"Symbol","value":"en","object_id":3894428}},{"id":716131,"event":"call","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parameters":[{"name":"locale","class":"Symbol","object_id":3894428,"value":"en","kind":"req"}],"receiver":{"class":"Class","object_id":70097569845280,"value":"LocaleSiteSetting"}},{"id":716132,"event":"return","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parent_id":716131,"elapsed":1.2e-05},{"id":716133,"event":"call","defined_class":"AppMap::Rails::ActionHandler::HTTPServerRequest","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/action_handler.rb","lineno":50,"static":false,"thread_id":70097708498960,"http_server_request":{"request_method":"GET","path_info":"/email_preferences.json"},"message":[{"name":"controller","class":"String","value":"email","object_id":70097756519740},{"name":"action","class":"String","value":"preferences_redirect","object_id":70097756519720},{"name":"format","class":"String","value":"json","object_id":70097799393540}]},{"id":716134,"event":"call","defined_class":"ApplicationController","method_id":"handle_theme","path":"app/controllers/application_controller.rb","lineno":388,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"EmailController","object_id":70097799392720,"value":"#<EmailController:0x00007f81d4dd5ba0>"}},{"id":716135,"event":"call","defined_class":"ApplicationController","method_id":"resolve_safe_mode","path":"app/controllers/application_controller.rb","lineno":377,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"EmailController","object_id":70097799392720,"value":"#<EmailController:0x00007f81d4dd5ba0>"}},{"id":716136,"event":"call","defined_class":"ApplicationController","method_id":"guardian","path":"app/controllers/application_controller.rb","lineno":423,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"EmailController","object_id":70097799392720,"value":"#<EmailController:0x00007f81d4dd5ba0>"}},{"id":716137,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097799405760,"value":"#<TestCurrentUserProvider:0x00007f81d4ddc180>"}},{"id":716138,"event":"call","defined_class":"UserAuthToken(id: integer, user_id: integer, auth_token: string, prev_auth_token: string, user_agent: string, auth_token_seen: boolean, client_ip: inet, rotated_at: datetime, created_at: datetime, updated_at: datetime, seen_at: datetime)","method_id":"lookup","path":"app/models/user_auth_token.rb","lineno":99,"static":true,"thread_id":70097708498960,"parameters":[{"name":"unhashed_token","class":"String","object_id":70097799428280,"value":"849b16cab9bb5628b8d1c822ec9f4e9d","kind":"req"},{"name":"opts","class":"Hash","object_id":70097799427860,"value":"{:seen=>true, :user_agent=>nil, :path=>nil, :client_ip=>\"127.0.0.1\"}","kind":"opt"}],"receiver":{"class":"Class","object_id":70097712007000,"value":"UserAuthToken"}},{"id":716139,"event":"call","defined_class":"UserAuthToken(id: integer, user_id: integer, auth_token: string, prev_auth_token: string, user_agent: string, auth_token_seen: boolean, client_ip: inet, rotated_at: datetime, created_at: datetime, updated_at: datetime, seen_at: datetime)","method_id":"hash_token","path":"app/models/user_auth_token.rb","lineno":164,"static":true,"thread_id":70097708498960,"parameters":[{"name":"token","class":"String","object_id":70097799428280,"value":"849b16cab9bb5628b8d1c822ec9f4e9d","kind":"req"}],"receiver":{"class":"Class","object_id":70097712007000,"value":"UserAuthToken"}},{"id":716140,"event":"call","defined_class":"GlobalSetting","method_id":"safe_secret_key_base","path":"app/models/global_setting.rb","lineno":25,"static":true,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"Class","object_id":70097703221560,"value":"GlobalSetting"}},{"id":716141,"event":"return","defined_class":"GlobalSetting","method_id":"safe_secret_key_base","path":"app/models/global_setting.rb","lineno":25,"static":true,"thread_id":70097708498960,"parent_id":716140,"elapsed":1.6e-05,"return_value":{"class":"String","value":"9a861fe75a448752d4997880bb647b45e1a210a880a56024d1dc12cdd3fa29354dc83c1a5e3ff086d25ac9454040e6f43418","object_id":70097709303360}},{"id":716142,"event":"return","defined_class":"UserAuthToken(id: integer, user_id: integer, auth_token: string, prev_auth_token: string, user_agent: string, auth_token_seen: boolean, client_ip: inet, rotated_at: datetime, created_at: datetime, updated_at: datetime, seen_at: datetime)","method_id":"hash_token","path":"app/models/user_auth_token.rb","lineno":164,"static":true,"thread_id":70097708498960,"parent_id":716139,"elapsed":0.000227,"return_value":{"class":"String","value":"Y0gerLwz59wHcYJ/ELwNYwv6bTs=","object_id":70097799422700}},{"id":716143,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SELECT \"user_auth_tokens\".* FROM \"user_auth_tokens\" WHERE ((auth_token = 'Y0gerLwz59wHcYJ/ELwNYwv6bTs=' OR\n                          prev_auth_token = 'Y0gerLwz59wHcYJ/ELwNYwv6bTs=') AND rotated_at > '2020-03-29 18:57:34.966536') LIMIT 1","database_type":"postgres","server_version":110006}},{"id":716144,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":716143,"elapsed":0.001268},{"id":716145,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"UPDATE \"user_auth_tokens\" SET \"auth_token_seen\" = TRUE, \"seen_at\" = '2020-05-28 18:57:34.972537' WHERE \"user_auth_tokens\".\"id\" = 859 AND \"user_auth_tokens\".\"auth_token\" = 'Y0gerLwz59wHcYJ/ELwNYwv6bTs='","database_type":"postgres","server_version":110006}},{"id":716146,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":716145,"elapsed":0.001187},{"id":716147,"event":"call","defined_class":"UserAuthToken(id: integer, user_id: integer, auth_token: string, prev_auth_token: string, user_agent: string, auth_token_seen: boolean, client_ip: inet, rotated_at: datetime, created_at: datetime, updated_at: datetime, seen_at: datetime)","method_id":"log","path":"app/models/user_auth_token.rb","lineno":26,"static":true,"thread_id":70097708498960,"parameters":[{"name":"info","class":"Hash","object_id":70097828660100,"value":"{:action=>\"seen token\", :user_auth_token_id=>859, :user_id=>931, :auth_token=>\"Y0gerLwz59wHcYJ/ELwNY","kind":"req"}],"receiver":{"class":"Class","object_id":70097712007000,"value":"UserAuthToken"}},{"id":716148,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SAVEPOINT active_record_2","database_type":"postgres","server_version":110006}},{"id":716149,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":716148,"elapsed":0.00099},{"id":716150,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"INSERT INTO \"user_auth_token_logs\" (\"action\", \"user_auth_token_id\", \"user_id\", \"client_ip\", \"auth_token\", \"created_at\") VALUES ('seen token', 859, 931, '127.0.0.1/32', 'Y0gerLwz59wHcYJ/ELwNYwv6bTs=', '2020-05-28 18:57:34.982604') RETURNING \"id\"","database_type":"postgres","server_version":110006}},{"id":716151,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":716150,"elapsed":0.001169},{"id":716152,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"RELEASE SAVEPOINT active_record_2","database_type":"postgres","server_version":110006}},{"id":716153,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":716152,"elapsed":0.000843},{"id":716154,"event":"return","defined_class":"UserAuthToken(id: integer, user_id: integer, auth_token: string, prev_auth_token: string, user_agent: string, auth_token_seen: boolean, client_ip: inet, rotated_at: datetime, created_at: datetime, updated_at: datetime, seen_at: datetime)","method_id":"log","path":"app/models/user_auth_token.rb","lineno":26,"static":true,"thread_id":70097708498960,"parent_id":716147,"elapsed":0.014948,"return_value":{"class":"UserAuthTokenLog","value":"#<UserAuthTokenLog:0x00007f81d85b30b8>","object_id":70097828681820}},{"id":716155,"event":"return","defined_class":"UserAuthToken(id: integer, user_id: integer, auth_token: string, prev_auth_token: string, user_agent: string, auth_token_seen: boolean, client_ip: inet, rotated_at: datetime, created_at: datetime, updated_at: datetime, seen_at: datetime)","method_id":"lookup","path":"app/models/user_auth_token.rb","lineno":99,"static":true,"thread_id":70097708498960,"parent_id":716138,"elapsed":0.026675,"return_value":{"class":"UserAuthToken","value":"#<UserAuthToken:0x00007f81bba9bc78>","object_id":70097587985980}},{"id":716156,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SELECT \"users\".* FROM \"users\" WHERE \"users\".\"id\" = 931 LIMIT 1","database_type":"postgres","server_version":110006}},{"id":716157,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":716156,"elapsed":0.00121},{"id":716158,"event":"call","defined_class":"User","method_id":"suspended?","path":"app/models/user.rb","lineno":869,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"User","object_id":70097800134060,"value":"#<User:0x00007f81d4f3fb58>"}},{"id":716159,"event":"return","defined_class":"User","method_id":"suspended?","path":"app/models/user.rb","lineno":869,"static":false,"thread_id":70097708498960,"parent_id":716158,"elapsed":1.9e-05},{"id":716160,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"should_update_last_seen?","path":"lib/auth/default_current_user_provider.rb","lineno":286,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097799405760,"value":"#<TestCurrentUserProvider:0x00007f81d4ddc180>"}},{"id":716161,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"should_update_last_seen?","path":"lib/auth/default_current_user_provider.rb","lineno":286,"static":false,"thread_id":70097708498960,"parent_id":716160,"elapsed":0.001053,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":716162,"event":"call","defined_class":"User","method_id":"update_last_seen!","path":"app/models/user.rb","lineno":721,"static":false,"thread_id":70097708498960,"parameters":[{"name":"now","class":"NilClass","object_id":8,"value":null,"kind":"opt"}],"receiver":{"class":"User","object_id":70097800134060,"value":"#<User:0x00007f81d4f3fb58>"}},{"id":716163,"event":"call","defined_class":"User","method_id":"update_visit_record!","path":"app/models/user.rb","lineno":680,"static":false,"thread_id":70097708498960,"parameters":[{"name":"date","class":"Date","object_id":70097800147820,"value":"2020-05-28","kind":"req"}],"receiver":{"class":"User","object_id":70097800134060,"value":"#<User:0x00007f81d4f3fb58>"}},{"id":716164,"event":"call","defined_class":"User","method_id":"visit_record_for","path":"app/models/user.rb","lineno":676,"static":false,"thread_id":70097708498960,"parameters":[{"name":"date","class":"Date","object_id":70097800147820,"value":"2020-05-28","kind":"req"}],"receiver":{"class":"User","object_id":70097800134060,"value":"#<User:0x00007f81d4f3fb58>"}},{"id":716165,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SELECT \"user_visits\".* FROM \"user_visits\" WHERE \"user_visits\".\"user_id\" = 931 AND \"user_visits\".\"visited_at\" = '2020-05-28' LIMIT 1","database_type":"postgres","server_version":110006}},{"id":716166,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":716165,"elapsed":0.000943},{"id":716167,"event":"return","defined_class":"User","method_id":"visit_record_for","path":"app/models/user.rb","lineno":676,"static":false,"thread_id":70097708498960,"parent_id":716164,"elapsed":0.004905},{"id":716168,"event":"call","defined_class":"User","method_id":"create_visit_record!","path":"app/models/user.rb","lineno":671,"static":false,"thread_id":70097708498960,"parameters":[{"name":"date","class":"Date","object_id":70097800147820,"value":"2020-05-28","kind":"req"},{"name":"opts","class":"NilClass","object_id":8,"value":null,"kind":"opt"}],"receiver":{"class":"User","object_id":70097800134060,"value":"#<User:0x00007f81d4f3fb58>"}},{"id":716169,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SELECT \"user_stats\".\"user_id\", \"user_stats\".\"topics_entered\", \"user_stats\".\"time_read\", \"user_stats\".\"days_visited\", \"user_stats\".\"posts_read_count\", \"user_stats\".\"likes_given\", \"user_stats\".\"likes_received\", \"user_stats\".\"new_since\", \"user_stats\".\"read_faq\", \"user_stats\".\"first_post_created_at\", \"user_stats\".\"post_count\", \"user_stats\".\"topic_count\", \"user_stats\".\"bounce_score\", \"user_stats\".\"reset_bounce_score_after\", \"user_stats\".\"flags_agreed\", \"user_stats\".\"flags_disagreed\", \"user_stats\".\"flags_ignored\", \"user_stats\".\"first_unread_at\", \"user_stats\".\"distinct_badge_count\" FROM \"user_stats\" WHERE \"user_stats\".\"user_id\" = 931 LIMIT 1","database_type":"postgres","server_version":110006}},{"id":716170,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":716169,"elapsed":0.001016},{"id":716171,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"UPDATE \"user_stats\" SET \"days_visited\" = 1 WHERE \"user_stats\".\"user_id\" = 931","database_type":"postgres","server_version":110006}},{"id":716172,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":716171,"elapsed":0.001633},{"id":716173,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SAVEPOINT active_record_2","database_type":"postgres","server_version":110006}},{"id":716174,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":716173,"elapsed":0.000893},{"id":716175,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"INSERT INTO \"user_visits\" (\"user_id\", \"visited_at\") VALUES (931, '2020-05-28') RETURNING \"id\"","database_type":"postgres","server_version":110006}},{"id":716176,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":716175,"elapsed":0.00098},{"id":716177,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"RELEASE SAVEPOINT active_record_2","database_type":"postgres","server_version":110006}},{"id":716178,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":716177,"elapsed":0.000918},{"id":716179,"event":"return","defined_class":"User","method_id":"create_visit_record!","path":"app/models/user.rb","lineno":671,"static":false,"thread_id":70097708498960,"parent_id":716168,"elapsed":0.025071,"return_value":{"class":"UserVisit","value":"#<UserVisit:0x00007f81d86c5be0>","object_id":70097829244400}},{"id":716180,"event":"return","defined_class":"User","method_id":"update_visit_record!","path":"app/models/user.rb","lineno":680,"static":false,"thread_id":70097708498960,"parent_id":716163,"elapsed":0.03032,"return_value":{"class":"UserVisit","value":"#<UserVisit:0x00007f81d86c5be0>","object_id":70097829244400}},{"id":716181,"event":"call","defined_class":"User","method_id":"seen_before?","path":"app/models/user.rb","lineno":667,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"User","object_id":70097800134060,"value":"#<User:0x00007f81d4f3fb58>"}},{"id":716182,"event":"return","defined_class":"User","method_id":"seen_before?","path":"app/models/user.rb","lineno":667,"static":false,"thread_id":70097708498960,"parent_id":716181,"elapsed":2.6e-05},{"id":716183,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"UPDATE \"users\" SET \"last_seen_at\" = '2020-05-28 18:57:34.999928' WHERE \"users\".\"id\" = 931","database_type":"postgres","server_version":110006}},{"id":716184,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":716183,"elapsed":0.001275},{"id":716185,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"UPDATE \"users\" SET \"first_seen_at\" = '2020-05-28 18:57:34.999928' WHERE \"users\".\"id\" = 931","database_type":"postgres","server_version":110006}},{"id":716186,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":716185,"elapsed":0.001062},{"id":716187,"event":"return","defined_class":"User","method_id":"update_last_seen!","path":"app/models/user.rb","lineno":721,"static":false,"thread_id":70097708498960,"parent_id":716162,"elapsed":0.041177},{"id":716188,"event":"call","defined_class":"User","method_id":"update_ip_address!","path":"app/models/user.rb","lineno":715,"static":false,"thread_id":70097708498960,"parameters":[{"name":"new_ip_address","class":"String","object_id":70097800127780,"value":"127.0.0.1","kind":"req"}],"receiver":{"class":"User","object_id":70097800134060,"value":"#<User:0x00007f81d4f3fb58>"}},{"id":716189,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"UPDATE \"users\" SET \"ip_address\" = '127.0.0.1' WHERE \"users\".\"id\" = 931","database_type":"postgres","server_version":110006}},{"id":716190,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":716189,"elapsed":0.001086},{"id":716191,"event":"return","defined_class":"User","method_id":"update_ip_address!","path":"app/models/user.rb","lineno":715,"static":false,"thread_id":70097708498960,"parent_id":716188,"elapsed":0.004273,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":716192,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":716137,"elapsed":0.079773,"return_value":{"class":"User","value":"#<User:0x00007f81d4f3fb58>","object_id":70097800134060}},{"id":716193,"event":"return","defined_class":"ApplicationController","method_id":"guardian","path":"app/controllers/application_controller.rb","lineno":423,"static":false,"thread_id":70097708498960,"parent_id":716136,"elapsed":0.079925,"return_value":{"class":"Guardian","value":"#<Guardian:0x00007f81bbea4ce8>","object_id":70097590101620}},{"id":716194,"event":"call","defined_class":"Guardian","method_id":"can_enable_safe_mode?","path":"lib/guardian.rb","lineno":149,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"Guardian","object_id":70097590101620,"value":"#<Guardian:0x00007f81bbea4ce8>"}},{"id":716195,"event":"return","defined_class":"Guardian","method_id":"can_enable_safe_mode?","path":"lib/guardian.rb","lineno":149,"static":false,"thread_id":70097708498960,"parent_id":716194,"elapsed":1.0e-05,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":716196,"event":"return","defined_class":"ApplicationController","method_id":"resolve_safe_mode","path":"app/controllers/application_controller.rb","lineno":377,"static":false,"thread_id":70097708498960,"parent_id":716135,"elapsed":0.080198},{"id":716197,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097799405760,"value":"#<TestCurrentUserProvider:0x00007f81d4ddc180>"}},{"id":716198,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":716197,"elapsed":4.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81d4f3fb58>","object_id":70097800134060}},{"id":716199,"event":"call","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":136,"static":false,"thread_id":70097708498960,"sql_query":{"sql":"SELECT \"user_options\".* FROM \"user_options\" WHERE \"user_options\".\"user_id\" = 931 LIMIT 1","database_type":"postgres","server_version":110006}},{"id":716200,"event":"return","defined_class":"AppMap::Rails::SQLHandler","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/sql_handler.rb","lineno":138,"static":false,"thread_id":70097708498960,"parent_id":716199,"elapsed":0.001138},{"id":716201,"event":"call","defined_class":"ApplicationController","method_id":"guardian","path":"app/controllers/application_controller.rb","lineno":423,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"EmailController","object_id":70097799392720,"value":"#<EmailController:0x00007f81d4dd5ba0>"}},{"id":716202,"event":"return","defined_class":"ApplicationController","method_id":"guardian","path":"app/controllers/application_controller.rb","lineno":423,"static":false,"thread_id":70097708498960,"parent_id":716201,"elapsed":8.0e-06,"return_value":{"class":"Guardian","value":"#<Guardian:0x00007f81bbea4ce8>","object_id":70097590101620}},{"id":716203,"event":"call","defined_class":"Guardian","method_id":"allow_themes?","path":"lib/guardian.rb","lineno":474,"static":false,"thread_id":70097708498960,"parameters":[{"name":"theme_ids","class":"Array","object_id":70097621061040,"value":"[]","kind":"req"},{"name":"include_preview","class":"NilClass","object_id":8,"value":null,"kind":"key"}],"receiver":{"class":"Guardian","object_id":70097590101620,"value":"#<Guardian:0x00007f81bbea4ce8>"}},{"id":716204,"event":"return","defined_class":"Guardian","method_id":"allow_themes?","path":"lib/guardian.rb","lineno":474,"static":false,"thread_id":70097708498960,"parent_id":716203,"elapsed":7.0e-06,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":716205,"event":"return","defined_class":"ApplicationController","method_id":"handle_theme","path":"app/controllers/application_controller.rb","lineno":388,"static":false,"thread_id":70097708498960,"parent_id":716134,"elapsed":0.086131,"return_value":{"class":"Array","value":"[2]","object_id":70097621061040}},{"id":716206,"event":"call","defined_class":"ApplicationController","method_id":"set_current_user_for_logs","path":"app/controllers/application_controller.rb","lineno":294,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"EmailController","object_id":70097799392720,"value":"#<EmailController:0x00007f81d4dd5ba0>"}},{"id":716207,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097799405760,"value":"#<TestCurrentUserProvider:0x00007f81d4ddc180>"}},{"id":716208,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":716207,"elapsed":4.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81d4f3fb58>","object_id":70097800134060}},{"id":716209,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097799405760,"value":"#<TestCurrentUserProvider:0x00007f81d4ddc180>"}},{"id":716210,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":716209,"elapsed":4.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81d4f3fb58>","object_id":70097800134060}},{"id":716211,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097799405760,"value":"#<TestCurrentUserProvider:0x00007f81d4ddc180>"}},{"id":716212,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":716211,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81d4f3fb58>","object_id":70097800134060}},{"id":716213,"event":"return","defined_class":"ApplicationController","method_id":"set_current_user_for_logs","path":"app/controllers/application_controller.rb","lineno":294,"static":false,"thread_id":70097708498960,"parent_id":716206,"elapsed":0.000423,"return_value":{"class":"String","value":"email/preferences_redirect","object_id":70097621074300}},{"id":716214,"event":"call","defined_class":"ApplicationController","method_id":"clear_notifications","path":"app/controllers/application_controller.rb","lineno":302,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"EmailController","object_id":70097799392720,"value":"#<EmailController:0x00007f81d4dd5ba0>"}},{"id":716215,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097799405760,"value":"#<TestCurrentUserProvider:0x00007f81d4ddc180>"}},{"id":716216,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":716215,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81d4f3fb58>","object_id":70097800134060}},{"id":716217,"event":"return","defined_class":"ApplicationController","method_id":"clear_notifications","path":"app/controllers/application_controller.rb","lineno":302,"static":false,"thread_id":70097708498960,"parent_id":716214,"elapsed":0.000139},{"id":716218,"event":"call","defined_class":"ApplicationController","method_id":"set_locale","path":"app/controllers/application_controller.rb","lineno":328,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"EmailController","object_id":70097799392720,"value":"#<EmailController:0x00007f81d4dd5ba0>"}},{"id":716219,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097799405760,"value":"#<TestCurrentUserProvider:0x00007f81d4ddc180>"}},{"id":716220,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":716219,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81d4f3fb58>","object_id":70097800134060}},{"id":716221,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097799405760,"value":"#<TestCurrentUserProvider:0x00007f81d4ddc180>"}},{"id":716222,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":716221,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81d4f3fb58>","object_id":70097800134060}},{"id":716223,"event":"call","defined_class":"User","method_id":"effective_locale","path":"app/models/user.rb","lineno":321,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"User","object_id":70097800134060,"value":"#<User:0x00007f81d4f3fb58>"}},{"id":716224,"event":"return","defined_class":"User","method_id":"effective_locale","path":"app/models/user.rb","lineno":321,"static":false,"thread_id":70097708498960,"parent_id":716223,"elapsed":1.4e-05,"return_value":{"class":"String","value":"en_US","object_id":70097724286060}},{"id":716225,"event":"call","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parameters":[{"name":"locale","class":"Symbol","object_id":70097724306540,"value":"en_US","kind":"req"}],"receiver":{"class":"Class","object_id":70097569845280,"value":"LocaleSiteSetting"}},{"id":716226,"event":"return","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parent_id":716225,"elapsed":4.0e-06,"return_value":{"class":"Symbol","value":"en","object_id":3894428}},{"id":716227,"event":"call","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parameters":[{"name":"locale","class":"Symbol","object_id":3894428,"value":"en","kind":"req"}],"receiver":{"class":"Class","object_id":70097569845280,"value":"LocaleSiteSetting"}},{"id":716228,"event":"return","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parent_id":716227,"elapsed":1.1e-05},{"id":716229,"event":"call","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parameters":[{"name":"locale","class":"Symbol","object_id":70097724306540,"value":"en_US","kind":"req"}],"receiver":{"class":"Class","object_id":70097569845280,"value":"LocaleSiteSetting"}},{"id":716230,"event":"return","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parent_id":716229,"elapsed":3.0e-06,"return_value":{"class":"Symbol","value":"en","object_id":3894428}},{"id":716231,"event":"call","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parameters":[{"name":"locale","class":"Symbol","object_id":3894428,"value":"en","kind":"req"}],"receiver":{"class":"Class","object_id":70097569845280,"value":"LocaleSiteSetting"}},{"id":716232,"event":"return","defined_class":"LocaleSiteSetting","method_id":"fallback_locale","path":"app/models/locale_site_setting.rb","lineno":62,"static":true,"thread_id":70097708498960,"parent_id":716231,"elapsed":1.0e-05},{"id":716233,"event":"return","defined_class":"ApplicationController","method_id":"set_locale","path":"app/controllers/application_controller.rb","lineno":328,"static":false,"thread_id":70097708498960,"parent_id":716218,"elapsed":0.000814,"return_value":{"class":"Array","value":"[:en_US, :en]","object_id":70097621130920}},{"id":716234,"event":"call","defined_class":"ApplicationController","method_id":"set_mobile_view","path":"app/controllers/application_controller.rb","lineno":368,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"EmailController","object_id":70097799392720,"value":"#<EmailController:0x00007f81d4dd5ba0>"}},{"id":716235,"event":"return","defined_class":"ApplicationController","method_id":"set_mobile_view","path":"app/controllers/application_controller.rb","lineno":368,"static":false,"thread_id":70097708498960,"parent_id":716234,"elapsed":8.0e-06},{"id":716236,"event":"call","defined_class":"ApplicationController","method_id":"requires_login_arg","path":"app/controllers/application_controller.rb","lineno":669,"static":true,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"Class","object_id":70097756004840,"value":"EmailController"}},{"id":716237,"event":"return","defined_class":"ApplicationController","method_id":"requires_login_arg","path":"app/controllers/application_controller.rb","lineno":669,"static":true,"thread_id":70097708498960,"parent_id":716236,"elapsed":3.0e-06},{"id":716238,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097799405760,"value":"#<TestCurrentUserProvider:0x00007f81d4ddc180>"}},{"id":716239,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":716238,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81d4f3fb58>","object_id":70097800134060}},{"id":716240,"event":"call","defined_class":"EmailController","method_id":"preferences_redirect","path":"app/controllers/email_controller.rb","lineno":9,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"EmailController","object_id":70097799392720,"value":"#<EmailController:0x00007f81d4dd5ba0>"}},{"id":716241,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097799405760,"value":"#<TestCurrentUserProvider:0x00007f81d4ddc180>"}},{"id":716242,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":716241,"elapsed":7.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81d4f3fb58>","object_id":70097800134060}},{"id":716243,"event":"return","defined_class":"EmailController","method_id":"preferences_redirect","path":"app/controllers/email_controller.rb","lineno":9,"static":false,"thread_id":70097708498960,"parent_id":716240,"elapsed":0.000497,"return_value":{"class":"String","value":"<html><body>You are being <a href=\"http://test.localhost/u/bruce859/preferences\">redirected</a>.</bo","object_id":70097621144680}},{"id":716244,"event":"call","defined_class":"ApplicationController","method_id":"conditionally_allow_site_embedding","path":"app/controllers/application_controller.rb","lineno":92,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"EmailController","object_id":70097799392720,"value":"#<EmailController:0x00007f81d4dd5ba0>"}},{"id":716245,"event":"return","defined_class":"ApplicationController","method_id":"conditionally_allow_site_embedding","path":"app/controllers/application_controller.rb","lineno":92,"static":false,"thread_id":70097708498960,"parent_id":716244,"elapsed":8.0e-06},{"id":716246,"event":"call","defined_class":"ApplicationController","method_id":"dont_cache_page","path":"app/controllers/application_controller.rb","lineno":85,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"EmailController","object_id":70097799392720,"value":"#<EmailController:0x00007f81d4dd5ba0>"}},{"id":716247,"event":"return","defined_class":"ApplicationController","method_id":"dont_cache_page","path":"app/controllers/application_controller.rb","lineno":85,"static":false,"thread_id":70097708498960,"parent_id":716246,"elapsed":8.0e-06,"return_value":{"class":"Array","value":"[\"no-store\"]","object_id":70097621141400}},{"id":716248,"event":"call","defined_class":"ApplicationController","method_id":"perform_refresh_session","path":"app/controllers/application_controller.rb","lineno":75,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"EmailController","object_id":70097799392720,"value":"#<EmailController:0x00007f81d4dd5ba0>"}},{"id":716249,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097799405760,"value":"#<TestCurrentUserProvider:0x00007f81d4ddc180>"}},{"id":716250,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":716249,"elapsed":4.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81d4f3fb58>","object_id":70097800134060}},{"id":716251,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"refresh_session","path":"lib/auth/default_current_user_provider.rb","lineno":173,"static":false,"thread_id":70097708498960,"parameters":[{"name":"user","class":"User","object_id":70097800134060,"value":"#<User:0x00007f81d4f3fb58>","kind":"req"},{"name":"session","class":"ActionDispatch::Request::Session","object_id":70097587803700,"value":"#<ActionDispatch::Request::Session:0x00007f81bba42c68>","kind":"req"},{"name":"cookies","class":"ActionDispatch::Cookies::CookieJar","object_id":70097621061340,"value":"#<ActionDispatch::Cookies::CookieJar:0x00007f81bf9b1db8>","kind":"req"}],"receiver":{"class":"TestCurrentUserProvider","object_id":70097799405760,"value":"#<TestCurrentUserProvider:0x00007f81d4ddc180>"}},{"id":716252,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_api?","path":"lib/auth/default_current_user_provider.rb","lineno":271,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097799405760,"value":"#<TestCurrentUserProvider:0x00007f81d4ddc180>"}},{"id":716253,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097799405760,"value":"#<TestCurrentUserProvider:0x00007f81d4ddc180>"}},{"id":716254,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":716253,"elapsed":3.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81d4f3fb58>","object_id":70097800134060}},{"id":716255,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_api?","path":"lib/auth/default_current_user_provider.rb","lineno":271,"static":false,"thread_id":70097708498960,"parent_id":716252,"elapsed":0.000112},{"id":716256,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_user_api?","path":"lib/auth/default_current_user_provider.rb","lineno":276,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097799405760,"value":"#<TestCurrentUserProvider:0x00007f81d4ddc180>"}},{"id":716257,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097799405760,"value":"#<TestCurrentUserProvider:0x00007f81d4ddc180>"}},{"id":716258,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"current_user","path":"lib/auth/default_current_user_provider.rb","lineno":61,"static":false,"thread_id":70097708498960,"parent_id":716257,"elapsed":4.0e-06,"return_value":{"class":"User","value":"#<User:0x00007f81d4f3fb58>","object_id":70097800134060}},{"id":716259,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"is_user_api?","path":"lib/auth/default_current_user_provider.rb","lineno":276,"static":false,"thread_id":70097708498960,"parent_id":716256,"elapsed":0.000109},{"id":716260,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"refresh_session","path":"lib/auth/default_current_user_provider.rb","lineno":173,"static":false,"thread_id":70097708498960,"parent_id":716251,"elapsed":0.000527},{"id":716261,"event":"return","defined_class":"ApplicationController","method_id":"perform_refresh_session","path":"app/controllers/application_controller.rb","lineno":75,"static":false,"thread_id":70097708498960,"parent_id":716248,"elapsed":0.000776},{"id":716262,"event":"return","defined_class":"AppMap::Rails::ActionHandler::HTTPServerResponse","method_id":"call","path":"/Users/kgilpin/source/appland/appmap-ruby/lib/appmap/rails/action_handler.rb","lineno":85,"static":false,"thread_id":70097708498960,"parent_id":716133,"elapsed":0.091679,"http_server_response":{"status":302}},{"id":716263,"event":"call","defined_class":"Theme(id: integer, name: string, user_id: integer, created_at: datetime, updated_at: datetime, compiler_version: integer, user_selectable: boolean, hidden: boolean, color_scheme_id: integer, remote_theme_id: integer, component: boolean, enabled: boolean)","method_id":"transform_ids","path":"app/models/theme.rb","lineno":162,"static":true,"thread_id":70097708498960,"parameters":[{"name":"ids","class":"Array","object_id":70097621061040,"value":"[2]","kind":"req"},{"name":"extend","class":"NilClass","object_id":8,"value":null,"kind":"key"}],"receiver":{"class":"Class","object_id":70097801647920,"value":"Theme"}},{"id":716264,"event":"call","defined_class":"Theme(id: integer, name: string, user_id: integer, created_at: datetime, updated_at: datetime, compiler_version: integer, user_selectable: boolean, hidden: boolean, color_scheme_id: integer, remote_theme_id: integer, component: boolean, enabled: boolean)","method_id":"get_set_cache","path":"app/models/theme.rb","lineno":125,"static":true,"thread_id":70097708498960,"parameters":[{"name":"key","class":"String","object_id":70097621157840,"value":"extended_transformed_ids_2","kind":"req"},{"name":"blk","class":"NilClass","object_id":8,"value":null,"kind":"block"}],"receiver":{"class":"Class","object_id":70097801647920,"value":"Theme"}},{"id":716265,"event":"return","defined_class":"Theme(id: integer, name: string, user_id: integer, created_at: datetime, updated_at: datetime, compiler_version: integer, user_selectable: boolean, hidden: boolean, color_scheme_id: integer, remote_theme_id: integer, component: boolean, enabled: boolean)","method_id":"get_set_cache","path":"app/models/theme.rb","lineno":125,"static":true,"thread_id":70097708498960,"parent_id":716264,"elapsed":1.2e-05,"return_value":{"class":"Array","value":"[2]","object_id":70097612817640}},{"id":716266,"event":"return","defined_class":"Theme(id: integer, name: string, user_id: integer, created_at: datetime, updated_at: datetime, compiler_version: integer, user_selectable: boolean, hidden: boolean, color_scheme_id: integer, remote_theme_id: integer, component: boolean, enabled: boolean)","method_id":"transform_ids","path":"app/models/theme.rb","lineno":162,"static":true,"thread_id":70097708498960,"parent_id":716263,"elapsed":0.000137,"return_value":{"class":"Array","value":"[2]","object_id":70097612817640}},{"id":716267,"event":"call","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"has_auth_cookie?","path":"lib/auth/default_current_user_provider.rb","lineno":281,"static":false,"thread_id":70097708498960,"parameters":[],"receiver":{"class":"TestCurrentUserProvider","object_id":70097621165420,"value":"#<TestCurrentUserProvider:0x00007f81bf9e4ad8>"}},{"id":716268,"event":"return","defined_class":"Auth::DefaultCurrentUserProvider","method_id":"has_auth_cookie?","path":"lib/auth/default_current_user_provider.rb","lineno":281,"static":false,"thread_id":70097708498960,"parent_id":716267,"elapsed":9.0e-06,"return_value":{"class":"TrueClass","value":"true","object_id":20}},{"id":716269,"event":"call","defined_class":"ApplicationRequest(id: integer, date: date, req_type: integer, count: integer)","method_id":"increment!","path":"app/models/application_request.rb","lineno":26,"static":true,"thread_id":70097708498960,"parameters":[{"name":"type","class":"Symbol","object_id":13040028,"value":"http_total","kind":"req"},{"name":"opts","class":"NilClass","object_id":8,"value":null,"kind":"opt"}],"receiver":{"class":"Class","object_id":70097802320860,"value":"ApplicationRequest"}},{"id":716270,"event":"return","defined_class":"ApplicationRequest(id: integer, date: date, req_type: integer, count: integer)","method_id":"increment!","path":"app/models/application_request.rb","lineno":26,"static":true,"thread_id":70097708498960,"parent_id":716269,"elapsed":7.0e-06},{"id":716271,"event":"call","defined_class":"ApplicationRequest(id: integer, date: date, req_type: integer, count: integer)","method_id":"increment!","path":"app/models/application_request.rb","lineno":26,"static":true,"thread_id":70097708498960,"parameters":[{"name":"type","class":"Symbol","object_id":13041628,"value":"http_3xx","kind":"req"},{"name":"opts","class":"NilClass","object_id":8,"value":null,"kind":"opt"}],"receiver":{"class":"Class","object_id":70097802320860,"value":"ApplicationRequest"}},{"id":716272,"event":"return","defined_class":"ApplicationRequest(id: integer, date: date, req_type: integer, count: integer)","method_id":"increment!","path":"app/models/application_request.rb","lineno":26,"static":true,"thread_id":70097708498960,"parent_id":716271,"elapsed":4.0e-06}]}